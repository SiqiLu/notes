---
title: Astro å“åº”å¼å›¾ç‰‡æ–¹æ¡ˆ
description: åŸºäº Device Matrix v2025.1 çš„ Astro å“åº”å¼å›¾ç‰‡å®Œæ•´è§„èŒƒï¼Œæ¶µç›– Desktop å’Œ Mobile ç«™ç‚¹çš„ä¸‰ç§å…¸å‹åœºæ™¯
lastUpdated: 2025-10-16
tags: [astro, responsive-images, device-matrix, web-performance, specification]
---

> æœ¬æ–‡é¢å‘å‰ç«¯/è®¾è®¡/äº§å“å·¥ç¨‹å›¢é˜Ÿï¼Œç”¨äºåœ¨ **Astro** é¡¹ç›®ä¸­ï¼ŒåŸºäºç»Ÿä¸€çš„**è®¾å¤‡çŸ©é˜µï¼ˆDevice Matrixï¼‰**ï¼Œå®ç°ç¨³å®šã€å¯å¤ç”¨ã€å¯éªŒè¯çš„**å“åº”å¼å›¾ç‰‡**æ–¹æ¡ˆã€‚æˆ‘ä»¬é‡‡ç”¨ **Desktop ç«™ç‚¹** ä¸ **Mobile ç«™ç‚¹** åˆ†æ²»ï¼Œå¹¶é€šè¿‡ **ä¸‰ç±»å…¸å‹åœºæ™¯**ï¼ˆè§†å£ 100% å®½ã€è§†å£ 30% å®½ã€å›ºå®š 30â€“100pxï¼‰æ¼”ç¤ºå®Œæ•´çš„å®ç°æ–¹æ³•ã€‚
>
> **åŸºäº**: Device Matrix v2025.1 (2025-10-10)

---

> âš ï¸ **é‡è¦æ¦‚å¿µåŒºåˆ†**
> æœ¬æ–‡æ¡£è®¨è®ºçš„æ˜¯**å›¾ç‰‡èµ„æºçš„å“åº”å¼ä¼˜åŒ–**ï¼ˆåŸºäºç‰©ç†åˆ†è¾¨ç‡ï¼‰ï¼Œè€Œé **CSS å¸ƒå±€çš„å“åº”å¼è®¾è®¡**ï¼ˆåŸºäº CSS åˆ†è¾¨ç‡ï¼‰ã€‚
>
> - **å›¾ç‰‡å“åº”å¼ä¼˜åŒ–**ï¼šæ ¹æ®è®¾å¤‡çš„ **Physical Width (ç‰©ç†åˆ†è¾¨ç‡)** é€‰æ‹©åˆé€‚å°ºå¯¸çš„å›¾ç‰‡ï¼Œé¿å…æµªè´¹å¸¦å®½
> - **CSS å“åº”å¼è®¾è®¡**ï¼šæ ¹æ®è®¾å¤‡çš„ **CSS Width (é€»è¾‘åˆ†è¾¨ç‡)** è°ƒæ•´é¡µé¢å¸ƒå±€ï¼ˆMedia Queriesï¼‰
>   **ç¤ºä¾‹**ï¼šMacBook Air 13â€³ (CSS 1280px Ã— DPR 2.0 = **2560px physical**)
> - CSS å“åº”å¼ï¼šä½¿ç”¨ `@media (min-width: 1280px)` çš„ Desktop å¸ƒå±€
> - å›¾ç‰‡å“åº”å¼ï¼šé€šè¿‡ `srcset` åŠ è½½ 2560px å®½åº¦çš„å›¾ç‰‡èµ„æº
>   è¿™ä¸¤è€…æ˜¯**äº’è¡¥**çš„ï¼Œä¸æ˜¯æ›¿ä»£å…³ç³»ã€‚æœ¬æ–‡æ¡£ä¸“æ³¨äºå›¾ç‰‡èµ„æºçš„ç‰©ç†å®½åº¦ä¼˜åŒ–ã€‚

---

## 0. æ–‡æ¡£ä¿¡æ¯ä¸æœ¯è¯­

- **é€‚ç”¨èŒƒå›´**ï¼šDesktop ç«™ç‚¹ï¼ˆè¦†ç›– Tablet / Laptop / Desktopï¼‰ä¸ Mobile ç«™ç‚¹ï¼ˆè¦†ç›– Mobileï¼‰ã€‚
- **ç«™ç‚¹è·¯ç”±ç­–ç•¥**ï¼šé€šè¿‡è®¾å¤‡ç±»å‹è¿›è¡Œè·¯ç”±åˆ†å‘ï¼ŒMobile è®¾å¤‡è®¿é—® Mobile ç«™ç‚¹ï¼Œå…¶ä½™è®¾å¤‡è®¿é—® Desktop ç«™ç‚¹ã€‚
- **å…³é”®æœ¯è¯­**ï¼š
  - **CSS px**ï¼šå¸ƒå±€é€»è¾‘åƒç´ ï¼Œ`window.innerWidth` è¿”å›çš„å€¼ã€‚
  - **Physical Width (px)**ï¼šç‰©ç†æ¸²æŸ“å®½åº¦ = CSS Width Ã— DPRï¼Œæµè§ˆå™¨å®é™…éœ€è¦æ¸²æŸ“çš„åƒç´ å®½åº¦ã€‚
  - **DPR**ï¼šè®¾å¤‡åƒç´ æ¯”ï¼ˆDevice Pixel Ratioï¼‰ï¼Œæµè§ˆå™¨æ®æ­¤åœ¨ `srcset` ä¸­é€‰æ‹©èµ„æºã€‚
  - **`vw`**ï¼šè§†å£å®½åº¦å•ä½ï¼›`1vw = è§†å£å®½åº¦çš„ 1%`ã€‚
  - **`srcset` (`w` æè¿°ç¬¦)**ï¼šå€™é€‰èµ„æºçš„**ç‰©ç†åƒç´ å®½åº¦**åˆ—è¡¨ã€‚
  - **`sizes`**ï¼šå‘ŠçŸ¥æµè§ˆå™¨å›¾ç‰‡åœ¨ä¸åŒè§†å£ä¸‹çš„**CSS æ˜¾ç¤ºå®½åº¦**ï¼Œç”¨äºé€‰å–æœ€åˆé€‚çš„ `srcset` å€™é€‰ã€‚
  - **ç¦»æ•£æ–­ç‚¹ (Breakpoint Strategy)**ï¼šæœ¬æ–‡æ¡£ä¸­çš„"æ–­ç‚¹"æŒ‡**å›¾ç‰‡èµ„æºçš„ç‰©ç†å®½åº¦æ–­ç‚¹**ï¼ˆå¦‚ 1080, 1206, 1320ï¼‰ï¼ŒåŒºåˆ«äº CSS å“åº”å¼è®¾è®¡ä¸­çš„ CSS å®½åº¦æ–­ç‚¹ï¼ˆå¦‚ 375px, 768px, 1024pxï¼‰ã€‚é‡‡ç”¨æœ‰é™æ•°é‡çš„ã€é—´éš”åˆ†å¸ƒçš„å›¾ç‰‡å®½åº¦ï¼Œè€Œéä¸ºæ¯ä¸ªå¯èƒ½çš„åƒç´ å€¼ç”Ÿæˆå›¾ç‰‡ã€‚æµè§ˆå™¨ä¼šæ ¹æ® `sizes` è®¡ç®—å‡ºå®é™…æ‰€éœ€å®½åº¦åï¼Œä» `srcset` ä¸­è‡ªåŠ¨é€‰æ‹©å€™é€‰å›¾ç‰‡ï¼Œé€‰æ‹©è§„åˆ™ä¸ºï¼šä¼˜å…ˆé€‰æ‹©**æœ€æ¥è¿‘ä¸”ä¸å°äº**æ‰€éœ€å®½åº¦çš„å€™é€‰ï¼›è‹¥æ‰€æœ‰å€™é€‰éƒ½å°äºæ‰€éœ€å®½åº¦ï¼Œåˆ™é€‰æ‹©**æœ€å¤§**çš„å€™é€‰ã€‚è¿™ç§ç­–ç•¥å¯ä»¥å¤§å¹…å‡å°‘ç”Ÿæˆçš„å›¾ç‰‡æ•°é‡ï¼ˆé€šå¸¸ 5-8 ä¸ªæ–­ç‚¹å³å¯è¦†ç›–æ‰€æœ‰è®¾å¤‡ï¼‰ï¼ŒåŒæ—¶ä¿æŒè‰¯å¥½çš„è§†è§‰æ•ˆæœã€‚

---

## 1. èƒŒæ™¯ä¸ç›®æ ‡ï¼ˆæˆ‘ä»¬è¦è§£å†³ä»€ä¹ˆé—®é¢˜ï¼‰

- **é—®é¢˜**ï¼šä¸åŒè®¾å¤‡ä¸å¸ƒå±€ä¸‹å¦‚ä½•æ—¢"æ¸…æ™°ä¸ç³Š"ï¼Œåˆ"ä¸è¿‡åº¦æµªè´¹å¸¦å®½ä¸æ„å»ºæ—¶é—´"ï¼Ÿæ‰‹å†™ `<picture>`/`srcset` å®¹æ˜“å‡ºé”™ã€éš¾ä»¥ç»´æŠ¤ï¼Œä¸”ç¼ºä¹ç»Ÿä¸€çš„æ–­ç‚¹æ ‡å‡†ã€‚
- **ç›®æ ‡**ï¼š
  1. åŸºäº**è®¾å¤‡çŸ©é˜µ**ç»Ÿä¸€æ–­ç‚¹è¯­ä¹‰ï¼›
  2. ä½¿ç”¨ Astro `<Picture>` / `<Image>` è§„èŒƒåŒ–è¾“å‡ºï¼›
  3. æŒ‰**åŒç«™ç‚¹**åˆ†æ²»ï¼Œåˆ†åˆ«é’ˆå¯¹ Desktop ä¸ Mobile ä¼˜åŒ–ï¼›
  4. é€šè¿‡**å·¥å…·æ–¹æ³•**æŒ‰è®¾è®¡ç¨¿å®½åº¦**åŠ¨æ€ç”Ÿæˆæ–­ç‚¹**ï¼Œé¿å…"å†™æ­»å¸¸é‡"ï¼›
  5. **è®¾è®¡åŸºå‡†çº¦æŸ**ï¼šä»¥ **Physical Width 3840** ä½œä¸ºè®¾è®¡ç¨¿åŸºå‡†å®½åº¦ã€‚å›¾ç‰‡çš„æœ€å¤§å¯¼å‡ºå°ºå¯¸å–å†³äºå…¶åœ¨ 3840 å®½åº¦è®¾è®¡ç¨¿ä¸­çš„å®é™…å°ºå¯¸ã€‚ä¾‹å¦‚ï¼šæŸå›¾ç‰‡åœ¨ 3840 è®¾è®¡ç¨¿ä¸­å®½åº¦ä¸º 100pxï¼Œåˆ™æ— è®ºç›®æ ‡è®¾å¤‡ç‰©ç†å®½åº¦å¤šå¤§ï¼ˆå¦‚ Desktop 6K çš„ 6016pxï¼‰ï¼Œè¯¥å›¾ç‰‡çš„åŸå§‹è®¾è®¡ç¨¿å¯¼å‡ºå®½åº¦ä»ä¸º 100pxï¼Œç”Ÿæˆçš„ä¼˜åŒ–å›¾ç‰‡æœ€å¤§å®½åº¦ä¹Ÿä¸ä¼šè¶…è¿‡ 100pxã€‚

---

## 2. æŠ€æœ¯ç¯å¢ƒï¼ˆAstro ç»„ä»¶ä¸æ„å»ºï¼‰

- **`<Picture />`**ï¼ˆæ¥è‡ª `astro:assets`ï¼‰ï¼šä¸€æ¬¡è¾“å‡ºå¤šæ ¼å¼/å¤šå°ºå¯¸ï¼ˆ`<picture>` + `<source>` + `<img>`ï¼‰ã€‚
- **`<Image />`**ï¼ˆæ¥è‡ª `astro:assets`ï¼‰ï¼šè¾“å‡ºå•ä¸€ `<img>`ï¼Œå¯é…ç½®å•ä¸€æ ¼å¼ã€å¤šå°ºå¯¸ã€‚
- æ„å»ºæœŸä¼˜åŒ–ï¼ˆå…±åŒç‚¹ï¼‰ï¼šè‡ªåŠ¨ç”Ÿæˆ `srcset`/`sizes`ï¼Œå¡«å…… `width/height` ä»¥é¿å… CLSï¼Œå¼€å¯ `loading="lazy"`/`decoding="async"`ï¼Œèµ„æºå“ˆå¸Œä¸ç¼“å­˜å‹å¥½ã€‚

**è®¾è®¡äº¤ä»˜å»ºè®®**ï¼š

- **æ‘„å½±ç±»**ï¼š**JPEGï¼ˆsRGBï¼Œè´¨é‡ 90â€“95ï¼‰**ï¼ˆä½“ç§¯å¼‚å¸¸å¤§æ—¶å¯é™è‡³ 88â€“90ï¼‰ã€‚
- **é€æ˜/æ’ç”»/Logo**ï¼š**PNG**ï¼ˆæˆ–æ— æŸ WebPï¼‰ã€‚
- **å®½é«˜æ¯”**ï¼šä»¥è®¾è®¡ç¨¿ä¸ºå‡†ï¼ˆæ–‡ä¸­ä»¥ 16:9 ä¸¾ä¾‹ï¼Œé«˜åº¦æŒ‰å®é™…è®¾è®¡æ¯”ä¾‹æ›¿æ¢ï¼‰ã€‚

---

## 3. è®¾å¤‡çŸ©é˜µï¼ˆä¸¤æ‰¹ï¼‰â€” åŸºäº Device Matrix v2025.1

> è®¾è®¡åŸºå‡†ï¼šä»¥ **Physical Width 3840** ä½œä¸ºè®¾è®¡ç¨¿åŸºå‡†å®½åº¦ï¼Œå›¾ç‰‡çš„æœ€å¤§å¯¼å‡ºå°ºå¯¸å–å†³äºå…¶åœ¨ 3840 å®½åº¦è®¾è®¡ç¨¿ä¸­çš„å®é™…å°ºå¯¸ã€‚

### 3.1 Mobile ç«™ç‚¹è®¾å¤‡ï¼ˆè¦†ç›– Mobileï¼‰

| ç±»åˆ«        | Device ID       | Physical Width (px) | CSS Width (px) | DPR | ä»£è¡¨è®¾å¤‡                       |
| ----------- | --------------- | ------------------: | -------------: | --: | ------------------------------ |
| ğŸ“± Mobile S | `mobile-small`  |                1080 |            360 |   3 | Galaxy S25, Xiaomi 14          |
| ğŸ“± Mobile M | `mobile-medium` |                1206 |            402 |   3 | iPhone 17, iPhone 17 Pro       |
| ğŸ“± Mobile L | `mobile-large`  |                1320 |            440 |   3 | iPhone 17 Pro Max, Mate 70 Pro |

**è¯´æ˜**ï¼š

- Mobile ç«™ç‚¹æœåŠ¡äºæ‰€æœ‰ Mobile è®¾å¤‡ï¼ˆç‰©ç†å®½åº¦ 1080â€“1320pxï¼‰
- ä¸»æµç§»åŠ¨è®¾å¤‡ DPR èŒƒå›´ä¸º 2.625â€“3.75ï¼ˆiPhone å…¨ç³»åˆ— 3.0ï¼ŒSamsung åŸºç¡€æ¬¾ 3.0ã€Plus/Ultra æ¬¾ 2.8125/3.75ï¼ŒGoogle Pixel 2.625/3.0ï¼ŒHuawei/Xiaomi 3.0ï¼‰
- æœ¬æ–¹æ¡ˆæŒ‰ç‰©ç†å®½åº¦åˆ†ç±»ï¼ˆ1080/1206/1320ï¼‰ï¼Œå¯è¦†ç›–ä¸åŒ DPR è®¾å¤‡
- ç‰©ç†å®½åº¦å³ä¸º `srcset` ä¸­çš„ `w` æè¿°ç¬¦å€¼

### 3.2 Desktop ç«™ç‚¹è®¾å¤‡ï¼ˆè¦†ç›– Tablet + Laptop + Desktopï¼‰

#### 3.2.1 Tablet è®¾å¤‡ï¼ˆ3 æ¡£ï¼‰

| ç±»åˆ«        | Device ID       | Physical Width (px) | CSS Width (px) | DPR | ä»£è¡¨è®¾å¤‡                   |
| ----------- | --------------- | ------------------: | -------------: | --: | -------------------------- |
| ğŸ’» Tablet S | `tablet-small`  |                1600 |            533 |   3 | Samsung Tab S9             |
| ğŸ’» Tablet M | `tablet-medium` |                1668 |            834 |   2 | iPad Pro 11â€³, iPad Air 11â€³ |
| ğŸ’» Tablet L | `tablet-large`  |                2048 |           1024 |   2 | iPad Air 13â€³               |

#### 3.2.2 Laptop è®¾å¤‡ï¼ˆ4 æ¡£ï¼‰

| ç±»åˆ«         | Device ID       | Physical Width (px) | CSS Width (px) |     DPR | ä»£è¡¨è®¾å¤‡                            |
| ------------ | --------------- | ------------------: | -------------: | ------: | ----------------------------------- |
| ğŸ’» Laptop S  | `laptop-small`  |                1920 |      1280-1920 | 1.0-1.5 | Dell XPS 13 FHD, Surface Laptop 13â€³ |
| ğŸ’» Laptop M  | `laptop-medium` |                2560 |      1280-1664 | 1.5-2.0 | MacBook Air 13â€³, Surface Laptop 15â€³ |
| ğŸ’» Laptop L  | `laptop-large`  |                2880 |      1440-1512 |     2.0 | MacBook Air 15â€³, MacBook Pro 14â€³    |
| ğŸ’» Laptop XL | `laptop-xlarge` |                3456 |           1728 |     2.0 | MacBook Pro 16â€³, Dell XPS 15 OLED   |

**æ³¨**ï¼šLaptop è®¾å¤‡çš„ CSS Width ä¸ºèŒƒå›´å€¼ï¼Œå› ä¸åŒç¼©æ”¾æ¯”ä¾‹ï¼ˆ1.0/1.5/2.0ï¼‰å¯¼è‡´åŒä¸€ç‰©ç†åˆ†è¾¨ç‡å¯¹åº”ä¸åŒ CSS å®½åº¦ã€‚

#### 3.2.3 Desktop è®¾å¤‡ï¼ˆ5 æ¡£ï¼‰

| ç±»åˆ«                  | Device ID           | Physical Width (px) | CSS Width (px) | DPR / Scale | ä»£è¡¨è®¾å¤‡                           |
| --------------------- | ------------------- | ------------------: | -------------: | ----------: | ---------------------------------- |
| ğŸ–¥ï¸ Desktop 2K         | `desktop-2k`        |                2560 |           2560 |           1 | 27â€³ QHD Display (2560Ã—1440)        |
| ğŸ–¥ï¸ Desktop 4K         | `desktop-4k`        |                3840 |           3840 |           1 | 4K Display Native (UHD 27â€“32â€³)     |
| ğŸ–¥ï¸ Desktop 4K @1.5x   | `desktop-4k-1.5x`   |                3840 |           2560 |         1.5 | 4K Display @150% (Windows Default) |
| ğŸ–¥ï¸ Desktop 4K @Retina | `desktop-4k-retina` |     5120 â†’ **3840** |           2560 |           2 | iMac 5K, Pro Display XDR @Retina   |
| ğŸ–¥ï¸ Desktop 6K         | `desktop-6k`        |     6016 â†’ **3840** |           6016 |           1 | Pro Display XDR (6K Native)        |

**æ³¨**ï¼š

- Desktop 4K @1.5x ä¸ Desktop 4K çš„ç‰©ç†å®½åº¦ç›¸åŒï¼ˆå‡ä¸º 3840ï¼‰ï¼Œä½† CSS å®½åº¦ä¸åŒ

#### 3.2.4 Desktop ç«™ç‚¹ç‰©ç†å®½åº¦æ±‡æ€»ï¼ˆTablet + Laptop + Desktopï¼‰

Desktop ç«™ç‚¹è¦†ç›–**ä¸‰å¤§ç±»è®¾å¤‡**ï¼ˆTabletã€Laptopã€Desktopï¼‰ï¼Œå°†æ‰€æœ‰ç‰©ç†å®½åº¦å»é‡æ’åºåå¾—åˆ°ï¼š

```text
å®Œæ•´è®¾å¤‡çŸ©é˜µï¼š1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840, 5120, 6016
é»˜è®¤æ–­ç‚¹ï¼ˆdesignViewportWidth=3840ï¼‰ï¼š1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840
```

**æ¥æºè¯´æ˜**ï¼š

- **Tablet è®¾å¤‡ï¼ˆ3 æ¡£ï¼‰**: 1600, 1668, 2048
- **Laptop è®¾å¤‡ï¼ˆ4 æ¡£ï¼‰**: 1920, 2560, 2880, 3456
- **Desktop è®¾å¤‡ï¼ˆ5 æ¡£ï¼‰**: 2560, 3840, 5120, 6016
  - Desktop 2K: 2560
  - Desktop 4K / 4K @1.5x: 3840
  - Desktop 4K @Retina (iMac 5K, Pro Display XDR @Retina): 5120
  - Desktop 6K (Pro Display XDR Native): 6016
- **å»é‡å**: 1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840, 5120, 6016

**è¯´æ˜**ï¼š

- Desktop 2K (2560) ä¸ Laptop M (2560) ç‰©ç†å®½åº¦ç›¸åŒï¼Œå»é‡åä¿ç•™ä¸€ä¸ª
- é»˜è®¤æƒ…å†µä¸‹ï¼ˆ`designViewportWidth=3840`ï¼‰ï¼Œæ–­ç‚¹ä¼šè¢«å°é¡¶åˆ° 3840ï¼Œå¾—åˆ° **8 ä¸ªç¦»æ•£æ–­ç‚¹**
- é€šè¿‡è®¾ç½® `designViewportWidth=5120` æˆ– `6016`ï¼Œå¯ä»¥åŒ…å« 5K/6K æ˜¾ç¤ºå™¨çš„æ–­ç‚¹ï¼Œå¾—åˆ° **9 æˆ– 10 ä¸ªæ–­ç‚¹**
- è¿™æ ·çš„è®¾è®¡å…¼é¡¾äº†é»˜è®¤è¡Œä¸ºçš„é«˜æ•ˆæ€§å’Œå¯¹é«˜åˆ†è¾¨ç‡æ˜¾ç¤ºå™¨çš„çµæ´»æ”¯æŒ

---

## 4. è®¾è®¡åŸåˆ™ä¸æ–­ç‚¹å·¥å…·æ–¹æ³•

### 4.1 è®¾è®¡ä¸é€‰æ‹©åŸåˆ™

- **è®¾è®¡åŸºå‡†**ï¼šä»¥ **Physical Width 3840** ä½œä¸ºè®¾è®¡ç¨¿åŸºå‡†å®½åº¦ï¼Œä½œä¸ºå›¾ç‰‡çš„é»˜è®¤æœ€å¤§å¯¼å‡ºå°ºå¯¸ä¸Šé™ã€‚å®é™…é¡¹ç›®ä¸­ï¼Œå›¾ç‰‡çš„æœ€å¤§å®½åº¦ç”± `maxWidth` å‚æ•°æ§åˆ¶ï¼Œå¯ä»¥æ ¹æ®å›¾ç‰‡åœ¨è®¾è®¡ç¨¿ä¸­çš„å®é™…å°ºå¯¸çµæ´»è®¾ç½®ï¼ˆå¦‚å…¨å®½å›¾ç‰‡ä¸º 3840ï¼Œå¡ç‰‡ç¼©ç•¥å›¾å¯èƒ½ä¸º 1152ï¼‰ã€‚
- **æ¼”ç¤ºåœºæ™¯è¯´æ˜**ï¼šæœ¬æ–¹æ¡ˆé€šè¿‡ä»¥ä¸‹ä¸‰ç±»å…¸å‹åœºæ™¯æ¼”ç¤ºå¦‚ä½•å¤„ç†ä¸åŒå¸ƒå±€éœ€æ±‚çš„å“åº”å¼å›¾ç‰‡ï¼Œä½†**å·¥å…·å‡½æ•°æ”¯æŒä»»æ„æ¯”ä¾‹å’Œå°ºå¯¸èŒƒå›´**ï¼Œä¸é™äºè¿™ä¸‰ç§åœºæ™¯ï¼š
  - **åœºæ™¯ 1ï¼ˆè§†å£ 100% å®½ï¼‰**ï¼šå›¾ç‰‡å æ»¡è§†å£å®½åº¦ï¼ˆå¦‚ Hero Bannerï¼‰ï¼ŒæŒ‰ **Physical Width** ä¸ºåŸºå‡†ç”Ÿæˆå€™é€‰å®½åº¦ã€‚
  - **åœºæ™¯ 2ï¼ˆè§†å£ 30% å®½ï¼‰**ï¼šå›¾ç‰‡å è§†å£å®½åº¦çš„ 30%ï¼ˆå¦‚å¡ç‰‡ç¼©ç•¥å›¾ï¼‰ï¼ŒæŒ‰ **Physical Width Ã— 0.3** è®¡ç®—ï¼Œä¸Šé™ **3840Ã—0.3 = 1152**ã€‚
  - **åœºæ™¯ 3ï¼ˆå›ºå®š 30â€“100pxï¼‰**ï¼šå›ºå®šå°ºå¯¸å›¾ç‰‡ï¼ˆå¦‚å¤´åƒ/å›¾æ ‡ï¼‰ï¼Œç›´æ¥åœ¨åŒºé—´ [30,100] ç”Ÿæˆå€™é€‰å®½åº¦ï¼Œä¸å—è§†å£å½±å“ã€‚
  - **å…¶ä»–åœºæ™¯**ï¼šå¦‚ 50% å®½ä¾§æ å›¾ç‰‡ã€å›ºå®š 200px Logoã€æœ€å°å®½åº¦ 800px çš„å¤§å›¾ç­‰ï¼Œå‡å¯é€šè¿‡è°ƒæ•´ `ratio`ã€`minWidth`ã€`maxWidth` å‚æ•°å®ç°ã€‚
- **ç¦»æ•£æ–­ç‚¹ç­–ç•¥**ï¼šé‡‡ç”¨æœ‰é™æ•°é‡çš„å›¾ç‰‡å®½åº¦ï¼ˆå¦‚ Desktop ç«™ç‚¹é»˜è®¤ä½¿ç”¨ 8 ä¸ªæ–­ç‚¹ï¼Œæ”¯æŒ 5K/6K æ˜¾ç¤ºå™¨æ—¶æœ€å¤š 10 ä¸ªæ–­ç‚¹ï¼‰ï¼Œè€Œéä¸ºæ¯ä¸ªè®¾å¤‡ç²¾ç¡®ç”Ÿæˆã€‚åŸå› ï¼š(1) æ»šåŠ¨æ¡/ä¾§æ /çª—å£éæœ€å¤§åŒ–ç­‰ä¼šä½¿å®é™…æ˜¾ç¤ºå®½åº¦æ³¢åŠ¨ï¼›(2) æµè§ˆå™¨ä¼šè‡ªåŠ¨é€‰æ‹©æœ€åˆé€‚çš„å€™é€‰ï¼ˆä¼˜å…ˆé€‰æ‹©æœ€æ¥è¿‘ä¸”ä¸å°äºæ‰€éœ€å®½åº¦çš„å›¾ç‰‡ï¼Œè‹¥æ— åˆ™é€‰æ‹©æœ€å¤§çš„å›¾ç‰‡ï¼‰ï¼›(3) å¯æ˜¾è‘—å‡å°‘æ„å»ºæ—¶é—´å’Œå­˜å‚¨æˆæœ¬ã€‚
- **å–æ•´ç­–ç•¥**ï¼šå‘ä¸Šå–åˆ°å·¥ç¨‹å‹å¥½å€¼ï¼ˆå»ºè®®æ­¥è¿› 16ï¼›ä¹Ÿå¯é…ç½®ä¸º 8/4/1ï¼‰ã€‚

### 4.2 æ–­ç‚¹å·¥å…·æ–¹æ³•ï¼ˆçµæ´»çš„æ¯”ä¾‹ä¸çº¦æŸï¼‰

> **æ–‡ä»¶è·¯å¾„**ï¼ˆæ¨èï¼‰ï¼š`utils/image_breakpoints.ts`
> æœ¬èŠ‚ä»£ç å¯ç›´æ¥å¤åˆ¶åˆ°é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œæ— éœ€é¢å¤–ä¾èµ–ã€‚

````ts
// ============================================================
// ç±»å‹å®šä¹‰
// ============================================================

/**
 * æ–­ç‚¹é…ç½®é€‰é¡¹
 *
 * @remarks
 * åŸºç¡€é…ç½®é€‰é¡¹ï¼ŒåŒ…å«é€šç”¨çš„é…ç½®å‚æ•°ï¼ˆæœ€å¤§/æœ€å°å®½åº¦ã€å–æ•´æ­¥è¿›ç­‰ï¼‰
 *
 * å½“ä¸ä¼  ratio å‚æ•°æ—¶ï¼Œæœ‰ä¸¤ç§è¡Œä¸ºï¼š
 * 1. åªä¼  maxWidthï¼šè‡ªåŠ¨ä» 3840 åæ¨ ratioï¼ˆå¦‚ maxWidth=1500 â†’ ratioâ‰ˆ0.39ï¼‰
 * 2. éƒ½ä¸ä¼ ï¼šé»˜è®¤ ratio=1.0ï¼ˆ100vwï¼‰ï¼ŒmaxWidth=3840
 *
 * @example é»˜è®¤ 100% å®½åº¦
 * ```ts
 * computeDesktopBreakpoints({})
 * // => { widths: [1600, 1680, 1920, ...] }
 * ```
 *
 * @example è‡ªåŠ¨åæ¨ ratio
 * ```ts
 * computeDesktopBreakpoints({ maxWidth: 1500 })
 * // å†…éƒ¨è®¡ç®—: ratio = 1500 / 3840 â‰ˆ 0.391
 * // => { widths: [640, 656, 752, 816, 1008, 1136, 1360, 1500] }
 * ```
 */
interface BreakpointOptions {
  /**
   * å›¾ç‰‡æœ€å¤§å®½åº¦ï¼ˆåƒç´ ï¼‰
   *
   * @remarks
   * - ä¸ä¼ æ—¶ï¼šé»˜è®¤ä¸º 3840ï¼ˆDesktopï¼‰æˆ– 1320ï¼ˆMobileï¼‰
   * - ä¼ é€’æ—¶ï¼šä½œä¸ºå›¾ç‰‡çš„æœ€å¤§å¯¼å‡ºå°ºå¯¸ä¸Šé™
   * - å¦‚æœåŒæ—¶ä¼ äº† minWidthï¼Œå¿…é¡» maxWidth >= minWidth
   * - **é‡è¦**ï¼šç”¨æˆ·æ˜ç¡®æŒ‡å®šçš„ maxWidth ä¼šè¢«è§†ä¸ºå…³é”®æ–­ç‚¹ï¼Œå¿…å®šå‡ºç°åœ¨æœ€ç»ˆçš„æ–­ç‚¹æ•°ç»„ä¸­
   *
   * @example
   * ```ts
   * { maxWidth: 1152 }  // å¡ç‰‡ç¼©ç•¥å›¾æœ€å¤§ 1152pxï¼Œæ–­ç‚¹æ•°ç»„ä¸­å¿…åŒ…å« 1152
   * { maxWidth: 100 }   // å¤´åƒæœ€å¤§ 100pxï¼Œæ–­ç‚¹æ•°ç»„ä¸­å¿…åŒ…å« 100
   * ```
   */
  maxWidth?: number;

  /**
   * å›¾ç‰‡æœ€å°å®½åº¦ï¼ˆåƒç´ ï¼‰
   *
   * @remarks
   * - ç”¨äºè¿‡æ»¤æ‰å°äºæ­¤å€¼çš„æ–­ç‚¹å€™é€‰ï¼ˆåœ¨å–æ•´ååº”ç”¨ï¼‰
   * - **é‡è¦**ï¼šç”¨æˆ·æ˜ç¡®æŒ‡å®šçš„ minWidth ä¼šè¢«è§†ä¸ºå…³é”®æ–­ç‚¹ï¼Œå¿…å®šå‡ºç°åœ¨æœ€ç»ˆçš„æ–­ç‚¹æ•°ç»„ä¸­
   * - å¸¸è§ç”¨é€”ï¼šå›ºå®šå°ºå¯¸å›¾ç‰‡ã€è¿‡æ»¤è¿‡å°æ–­ç‚¹ã€å®šä¹‰å°ºå¯¸èŒƒå›´
   *
   * @example
   * ```ts
   * { minWidth: 800 }               // è¿‡æ»¤æ‰ < 800px çš„æ–­ç‚¹ï¼Œä¸”æ–­ç‚¹æ•°ç»„ä¸­å¿…åŒ…å« 800
   * { minWidth: 30, maxWidth: 100 } // å›ºå®šå°ºå¯¸èŒƒå›´ [30, 100]ï¼Œæ–­ç‚¹æ•°ç»„ä¸­å¿…åŒ…å« 30 å’Œ 100
   * { minWidth: 1000 }              // åªç”Ÿæˆå¤§å›¾æ–­ç‚¹ï¼Œä¸”ä» 1000px å¼€å§‹
   * ```
   */
  minWidth?: number;

  /**
   * å–æ•´æ­¥è¿›ï¼ˆåƒç´ ï¼‰
   *
   * @remarks
   * å°†è®¡ç®—å‡ºçš„æ–­ç‚¹å®½åº¦å‘ä¸Šå–æ•´åˆ°æ­¤å€¼çš„å€æ•°ï¼Œä½¿å®½åº¦æ›´"å·¥ç¨‹å‹å¥½"
   *
   * @default 16
   *
   * @example
   * ```ts
   * { roundStep: 16 }  // 1668 â†’ 1680
   * { roundStep: 8 }   // 1668 â†’ 1672
   * { roundStep: 1 }   // 1668 â†’ 1668ï¼ˆä¸å–æ•´ï¼‰
   * ```
   */
  roundStep?: number;

  /**
   * è®¾è®¡ç¨¿è§†å£å®½åº¦ï¼ˆåƒç´ ï¼‰
   *
   * @remarks
   * **é‡è¦è¯´æ˜**ï¼šæ­¤å‚æ•°è¡¨ç¤ºè®¾è®¡ç¨¿çš„è§†å£å®½åº¦ï¼ˆå³è®¾è®¡ç¨¿çš„ç”»å¸ƒå®½åº¦ï¼‰ï¼Œè€Œä¸æ˜¯å›¾ç‰‡æœ¬èº«çš„å®½åº¦ã€‚
   *
   * **ä½¿ç”¨åœºæ™¯**ï¼š
   * - å‡è®¾ä½ çš„è®¾è®¡ç¨¿æ˜¯åœ¨ 3840px å®½åº¦çš„ç”»å¸ƒä¸Šè®¾è®¡çš„
   * - è®¾è®¡ç¨¿ä¸­æŸå¼ å›¾ç‰‡æ˜¾ç¤ºä¸º 1000px å®½
   * - åˆ™åº”è¯¥ä¼ é€’ï¼š`maxWidth: 1000, designViewportWidth: 3840`
   *
   * **æ­¤å‚æ•°çš„å…³é”®ä½œç”¨**ï¼š
   * 1. **æ–­ç‚¹å®½åº¦ä¸Šé™**ï¼šæ‰€æœ‰ç”Ÿæˆçš„æ–­ç‚¹å®½åº¦ä¸ä¼šè¶…è¿‡æ­¤å€¼
   * 2. **åæ¨ ratio**ï¼šå½“ä»…æä¾› maxWidth æ—¶ï¼Œratio = maxWidth / designViewportWidth
   * 3. **é»˜è®¤æœ€å¤§å®½åº¦**ï¼šå½“ä¸æä¾›ä»»ä½•å‚æ•°æ—¶ï¼Œä½¿ç”¨æ­¤å€¼ä½œä¸ºæœ€å¤§å®½åº¦
   *
   * **é‡è¦çº¦æŸ**ï¼š
   * - å¿…é¡»æ»¡è¶³ï¼š`maxWidth <= designViewportWidth`
   * - å¦‚æœè¿åæ­¤çº¦æŸï¼Œä¼šæŠ›å‡ºé”™è¯¯
   * - å› ä¸ºå›¾ç‰‡å®½åº¦ä¸åº”è¯¥è¶…è¿‡è®¾è®¡ç¨¿è§†å£å®½åº¦
   *
   * @default
   * - Desktop: 3840 (å¯¹åº” 4K æ˜¾ç¤ºå™¨çš„ç‰©ç†å®½åº¦)
   * - Mobile: 1320 (å¯¹åº”æœ€å¤§ Mobile è®¾å¤‡çš„ç‰©ç†å®½åº¦)
   *
   * @example åŸºäº 1920px è®¾è®¡ç¨¿çš„ Desktop ç«™ç‚¹
   * ```ts
   * // è®¾è®¡ç¨¿è§†å£å®½åº¦æ˜¯ 1920pxï¼Œå›¾ç‰‡åœ¨è®¾è®¡ç¨¿ä¸Šæ˜¾ç¤º 1200px
   * computeDesktopBreakpoints({ maxWidth: 1200, designViewportWidth: 1920 })
   * // => ratio = 1200 / 1920 = 0.625 (62.5vw)
   * // => æ–­ç‚¹ä¸ä¼šè¶…è¿‡ 1920px
   * ```
   *
   * @example ä½¿ç”¨é»˜è®¤çš„ 3840px è®¾è®¡ç¨¿
   * ```ts
   * // é»˜è®¤ Desktop è®¾è®¡ç¨¿æ˜¯ 3840pxï¼Œå›¾ç‰‡æ˜¾ç¤º 1000px
   * computeDesktopBreakpoints({ maxWidth: 1000 })
   * // => designViewportWidth é»˜è®¤ä¸º 3840
   * // => ratio = 1000 / 3840 â‰ˆ 0.26 (26vw)
   * ```
   *
   * @example é”™è¯¯ç¤ºä¾‹ï¼šmaxWidth è¶…è¿‡ designViewportWidth
   * ```ts
   * // âŒ é”™è¯¯ï¼šå›¾ç‰‡å®½åº¦ 2400px è¶…è¿‡è®¾è®¡ç¨¿è§†å£å®½åº¦ 1920px
   * computeDesktopBreakpoints({ maxWidth: 2400, designViewportWidth: 1920 })
   * // => æŠ›å‡ºé”™è¯¯ï¼šmaxWidth must not exceed designViewportWidth
   * ```
   */
  designViewportWidth?: number;
}

/**
 * æ¯”ä¾‹é…ç½®é€‰é¡¹ï¼ˆä¼ é€’ ratio æ—¶ä½¿ç”¨ï¼‰
 *
 * @remarks
 * å½“ä¼ é€’ ratio å‚æ•°æ—¶ï¼Œè¡¨ç¤ºå›¾ç‰‡å è§†å£å®½åº¦çš„æ¯”ä¾‹ï¼ˆ0-1 ä¹‹é—´ï¼‰
 *
 * @example 30% å®½åº¦
 * ```ts
 * computeDesktopBreakpoints({ ratio: 0.3 })
 * // => { widths: [480, 512, 576, ...] }
 * ```
 *
 * @example 50% å®½åº¦ + æœ€å¤§å®½åº¦é™åˆ¶
 * ```ts
 * computeDesktopBreakpoints({ ratio: 0.5, maxWidth: 2000 })
 * // => { widths: [800, 848, 960, ..., 2000] }
 * ```
 */
interface RatioBreakpointOptions extends BreakpointOptions {
  /**
   * å›¾ç‰‡å è§†å£å®½åº¦çš„æ¯”ä¾‹
   *
   * @remarks
   * - å–å€¼èŒƒå›´ï¼š0 < ratio <= 1
   * - å¸¸è§å€¼ï¼š0.3 (30%), 0.5 (50%), 1.0 (100%)
   *
   * @example
   * ```ts
   * { ratio: 0.3 }   // å¡ç‰‡ç¼©ç•¥å›¾
   * { ratio: 0.5 }   // ä¾§æ å›¾ç‰‡
   * { ratio: 1.0 }   // å…¨å®½ Banner
   * ```
   */
  ratio: number;
}

/**
 * æ–­ç‚¹è®¡ç®—ç»“æœ
 *
 * @remarks
 * è¿”å›å€¼å¯ç›´æ¥ç”¨äº Astro çš„ `<Picture>` æˆ– `<Image>` ç»„ä»¶
 */
interface BreakpointResult {
  /**
   * srcset å€™é€‰å®½åº¦æ•°ç»„ï¼ˆå‡åºæ’åˆ—ï¼‰
   *
   * @remarks
   * - ç”¨äº `<Picture widths={widths}>` æˆ– `<Image widths={widths}>`
   * - æµè§ˆå™¨ä¼šæ ¹æ® DPR å’Œ sizes å±æ€§ä»ä¸­é€‰æ‹©æœ€åˆé€‚çš„å€™é€‰
   *
   * @example
   * ```ts
   * [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840]
   * ```
   */
  widths: number[];
}

// ============================================================
// å¸¸é‡å®šä¹‰ï¼ˆåŸºäº Device Matrix v2025.1ï¼‰
// ============================================================

/**
 * Mobile ç«™ç‚¹è®¾å¤‡ç‰©ç†å®½åº¦ï¼ˆå»é‡æ’åºåï¼‰
 *
 * @remarks
 * è¦†ç›–è®¾å¤‡ï¼š
 * - Mobile S (1080px): Galaxy S25, Xiaomi 14
 * - Mobile M (1206px): iPhone 17, iPhone 17 Pro
 * - Mobile L (1320px): iPhone 17 Pro Max, Mate 70 Pro
 */
const MOBILE_PHYSICAL = [1080, 1206, 1320] as const;

/**
 * Desktop ç«™ç‚¹è®¾å¤‡ç‰©ç†å®½åº¦ï¼ˆå»é‡æ’åºåï¼‰
 *
 * @remarks
 * è¦†ç›–è®¾å¤‡ç±»åˆ«ï¼š
 * - Tablet (3 æ¡£): 1600, 1668, 2048
 * - Laptop (4 æ¡£): 1920, 2560, 2880, 3456
 * - Desktop (5 æ¡£): 2560, 3840, 5120, 6016
 *   - Desktop 2K: 2560
 *   - Desktop 4K / 4K @1.5x: 3840
 *   - Desktop 4K @Retina (iMac 5K, Pro Display XDR @Retina): 5120
 *   - Desktop 6K (Pro Display XDR Native): 6016
 *
 * å»é‡åå…± 10 ä¸ªæ–­ç‚¹ï¼š1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840, 5120, 6016
 *
 * **é‡è¦è¯´æ˜**ï¼š
 * - é»˜è®¤æƒ…å†µä¸‹ï¼ˆdesignViewportWidth = 3840ï¼‰ï¼Œæ–­ç‚¹ä¼šè¢«å°é¡¶åˆ° 3840ï¼Œå®é™…ä½¿ç”¨ 8 ä¸ªæ–­ç‚¹
 * - å½“ç”¨æˆ·æŒ‡å®šæ›´å¤§çš„ designViewportWidthï¼ˆå¦‚ 5120 æˆ– 6016ï¼‰æ—¶ï¼Œä¼šåŒ…å«ç›¸åº”çš„æ›´å¤§æ–­ç‚¹
 * - è¿™æ ·è®¾è®¡å¯ä»¥è®©ç”¨æˆ·çµæ´»æ”¯æŒ 5K/6K æ˜¾ç¤ºå™¨ï¼ŒåŒæ—¶ä¿æŒé»˜è®¤è¡Œä¸ºçš„å‘åå…¼å®¹
 */
const DESKTOP_PHYSICAL = [1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840, 5120, 6016] as const;

/**
 * Desktop ç«™ç‚¹é»˜è®¤è®¾è®¡ç¨¿è§†å£å®½åº¦ï¼ˆå†…éƒ¨å¸¸é‡ï¼‰
 *
 * @remarks
 * è¡¨ç¤º Desktop ç«™ç‚¹è®¾è®¡ç¨¿çš„é»˜è®¤è§†å£å®½åº¦ï¼ˆç”»å¸ƒå®½åº¦ï¼‰ï¼Œå¯¹åº” 4K æ˜¾ç¤ºå™¨çš„ç‰©ç†å®½åº¦ã€‚
 *
 * ä½œç”¨ï¼š
 * 1. æ–­ç‚¹å®½åº¦ä¸Šé™ï¼šæ‰€æœ‰ç”Ÿæˆçš„æ–­ç‚¹ä¸ä¼šè¶…è¿‡æ­¤å€¼
 * 2. ç”¨äºåæ¨ ratioï¼šratio = maxWidth / DESKTOP_DESIGN_VIEWPORT_WIDTH
 * 3. é»˜è®¤æœ€å¤§å®½åº¦ï¼šå½“ä¸æä¾›å‚æ•°æ—¶çš„ upper å€¼
 */
const DESKTOP_DESIGN_VIEWPORT_WIDTH = 3840;

/**
 * Mobile ç«™ç‚¹é»˜è®¤è®¾è®¡ç¨¿è§†å£å®½åº¦ï¼ˆå†…éƒ¨å¸¸é‡ï¼‰
 *
 * @remarks
 * è¡¨ç¤º Mobile ç«™ç‚¹è®¾è®¡ç¨¿çš„é»˜è®¤è§†å£å®½åº¦ï¼ˆç”»å¸ƒå®½åº¦ï¼‰ï¼Œå¯¹åº”æœ€å¤§ Mobile è®¾å¤‡çš„ç‰©ç†å®½åº¦ã€‚
 *
 * ä½œç”¨ï¼š
 * 1. æ–­ç‚¹å®½åº¦ä¸Šé™ï¼šæ‰€æœ‰ç”Ÿæˆçš„æ–­ç‚¹ä¸ä¼šè¶…è¿‡æ­¤å€¼
 * 2. ç”¨äºåæ¨ ratioï¼šratio = maxWidth / MOBILE_DESIGN_VIEWPORT_WIDTH
 * 3. é»˜è®¤æœ€å¤§å®½åº¦ï¼šå½“ä¸æä¾›å‚æ•°æ—¶çš„ upper å€¼
 */
const MOBILE_DESIGN_VIEWPORT_WIDTH = 1320;

// ============================================================
// è¾…åŠ©å‡½æ•°
// ============================================================

/**
 * å°†æ•°å€¼å‘ä¸Šå–æ•´åˆ°æŒ‡å®šæ­¥è¿›çš„å€æ•°
 *
 * @param n - å¾…å–æ•´çš„æ•°å€¼ï¼ˆå¿…é¡» >= 0ï¼‰
 * @param step - å–æ•´æ­¥è¿›ï¼ˆå¿…é¡»ä¸ºæ­£æ•´æ•°ï¼Œå•ä½ï¼šåƒç´ ï¼‰
 * @returns å‘ä¸Šå–æ•´åçš„ç»“æœ
 *
 * @throws {Error} å½“ step <= 0 æ—¶ï¼ˆé˜²æ­¢é™¤ä»¥é›¶æˆ–è´Ÿæ•°æ­¥è¿›ï¼‰
 * @throws {Error} å½“ step ä¸æ˜¯æ•´æ•°æ—¶ï¼ˆåƒç´ å€¼å¿…é¡»ä¸ºæ•´æ•°ï¼‰
 * @throws {Error} å½“ n < 0 æ—¶ï¼ˆå›¾ç‰‡å®½åº¦ä¸åº”ä¸ºè´Ÿæ•°ï¼‰
 *
 * @example
 * ```ts
 * ceilToStep(1668, 16)  // => 1680
 * ceilToStep(1668, 8)   // => 1672
 * ceilToStep(1668, 1)   // => 1668
 * ```
 *
 * @example é”™è¯¯ç¤ºä¾‹
 * ```ts
 * ceilToStep(1668, 0)    // => æŠ›å‡ºé”™è¯¯ï¼šstep must be greater than 0
 * ceilToStep(1668, -16)  // => æŠ›å‡ºé”™è¯¯ï¼šstep must be greater than 0
 * ceilToStep(1668, 16.5) // => æŠ›å‡ºé”™è¯¯ï¼šstep must be an integer
 * ceilToStep(-100, 16)   // => æŠ›å‡ºé”™è¯¯ï¼šn must be non-negative
 * ```
 */
function ceilToStep(n: number, step: number): number {
  if (step <= 0) {
    throw new Error(`[ceilToStep] step must be greater than 0, got ${step}`);
  }
  if (!Number.isInteger(step)) {
    throw new Error(`[ceilToStep] step must be an integer (pixel values must be whole numbers), got ${step}`);
  }
  if (n < 0) {
    throw new Error(`[ceilToStep] n must be non-negative, got ${n}`);
  }
  return Math.ceil(n / step) * step;
}

// ============================================================
// æ ¸å¿ƒå‡½æ•°
// ============================================================

/**
 * è®¡ç®— Desktop ç«™ç‚¹çš„å“åº”å¼å›¾ç‰‡æ–­ç‚¹
 *
 * @remarks
 * Desktop ç«™ç‚¹è¦†ç›– **Tablet + Laptop + Desktop** è®¾å¤‡
 * - ç‰©ç†å®½åº¦èŒƒå›´ï¼š1600px - 6016pxï¼ˆå®Œæ•´è®¾å¤‡çŸ©é˜µï¼‰
 * - é»˜è®¤æœ€å¤§å®½åº¦ï¼š3840pxï¼ˆé»˜è®¤ä½¿ç”¨ 8 ä¸ªæ–­ç‚¹ï¼‰
 * - æ”¯æŒè‡ªå®šä¹‰ designViewportWidthï¼ˆå¦‚ 5120/6016ï¼‰ä»¥åŒ…å«æ›´å¤§æ–­ç‚¹
 *
 * **å‡½æ•°é‡è½½é€»è¾‘**ï¼š
 * 1. ä¸ä¼  ratioï¼šé»˜è®¤ 100vwï¼Œæˆ–ä» maxWidth åæ¨ ratio
 * 2. ä¼ é€’ ratioï¼šæŒ‰æŒ‡å®šæ¯”ä¾‹è®¡ç®—æ–­ç‚¹
 *
 * @param opts - æ–­ç‚¹é…ç½®é€‰é¡¹
 * @returns æ–­ç‚¹è®¡ç®—ç»“æœï¼ˆwidths æ•°ç»„ï¼‰
 *
 * @throws {Error} å½“ maxWidth < minWidth æ—¶
 * @throws {Error} å½“çº¦æŸæ¡ä»¶å¯¼è‡´æ— æœ‰æ•ˆæ–­ç‚¹æ—¶
 *
 * @example å…¨å®½å›¾ç‰‡
 * ```ts
 * const hero = computeDesktopBreakpoints({})
 * // è®¡ç®—è¿‡ç¨‹ï¼š
 * // 1. åŸå§‹ç‰©ç†å®½åº¦ï¼ˆDESKTOP_PHYSICAL, å–å‰8ä¸ªï¼‰: [1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840]
 * // 2. æŒ‰ ratio=1.0 ç¼©æ”¾: [1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840]
 * // 3. roundStep=16 å‘ä¸Šå–æ•´: [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840]
 * // 4. å°é¡¶åˆ° maxWidth=3840: [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840]
 * // => { widths: [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840] }
 * ```
 *
 * @example 30% å®½å¡ç‰‡ç¼©ç•¥å›¾
 * ```ts
 * const card = computeDesktopBreakpoints({ ratio: 0.3 })
 * // è®¡ç®—è¿‡ç¨‹ï¼š
 * // 1. åŸå§‹ç‰©ç†å®½åº¦: [1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840]
 * // 2. æŒ‰ ratio=0.3 ç¼©æ”¾: [480, 500.4, 576, 614.4, 768, 864, 1036.8, 1152]
 * // 3. roundStep=16 å‘ä¸Šå–æ•´: [480, 512, 576, 624, 768, 864, 1040, 1152]
 * // 4. å°é¡¶åˆ° upper=1152: [480, 512, 576, 624, 768, 864, 1040, 1152]
 * // => { widths: [480, 512, 576, 624, 768, 864, 1040, 1152] }
 * ```
 *
 * @example è‡ªåŠ¨åæ¨ ratioï¼ˆæœ€å¤§å®½åº¦ 1500pxï¼‰
 * ```ts
 * const medium = computeDesktopBreakpoints({ maxWidth: 1500 })
 * // è®¡ç®—è¿‡ç¨‹ï¼š
 * // 1. åæ¨ ratio = 1500 / 3840 â‰ˆ 0.391
 * // 2. åŸå§‹ç‰©ç†å®½åº¦: [1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840]
 * // 3. æŒ‰ ratio=0.391 ç¼©æ”¾: [625.6, 652.4, 750.7, 800.8, 1001.0, 1126.1, 1351.3, 1501.4]
 * // 4. roundStep=16 å‘ä¸Šå–æ•´: [640, 656, 752, 816, 1008, 1136, 1360, 1504]
 * // 5. å°é¡¶åˆ° maxWidth=1500: [640, 656, 752, 816, 1008, 1136, 1360, 1500]
 * // 6. å¼ºåˆ¶æ·»åŠ  maxWidth=1500: [640, 656, 752, 816, 1008, 1136, 1360, 1500]
 * // => { widths: [640, 656, 752, 816, 1008, 1136, 1360, 1500] }
 * ```
 *
 * @example å›ºå®šå°ºå¯¸å¤´åƒï¼ˆ30-100pxï¼‰
 * ```ts
 * const avatar = computeDesktopBreakpoints({ minWidth: 30, maxWidth: 100, roundStep: 1 })
 * // è®¡ç®—è¿‡ç¨‹ï¼š
 * // 1. åæ¨ ratio = 100 / 3840 â‰ˆ 0.026
 * // 2. åŸå§‹ç‰©ç†å®½åº¦: [1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840]
 * // 3. æŒ‰ ratio=0.026 ç¼©æ”¾: [41.6, 43.4, 50.0, 53.2, 66.6, 74.9, 89.9, 100.0]
 * // 4. roundStep=1 å‘ä¸Šå–æ•´: [42, 44, 50, 54, 67, 75, 90, 100]
 * // 5. å°é¡¶åˆ° maxWidth=100: [42, 44, 50, 54, 67, 75, 90, 100]
 * // 6. è¿‡æ»¤ minWidth=30: [42, 44, 50, 54, 67, 75, 90, 100]ï¼ˆéƒ½ >= 30ï¼‰
 * // 7. å¼ºåˆ¶æ·»åŠ  minWidth=30 å’Œ maxWidth=100: [30, 42, 44, 50, 54, 67, 75, 90, 100]
 * // => { widths: [30, 42, 44, 50, 54, 67, 75, 90, 100] }
 * ```
 *
 * @example 50% å®½ä¾§æ å›¾ç‰‡ + æœ€å¤§å®½åº¦ 2000px
 * ```ts
 * const sidebar = computeDesktopBreakpoints({ ratio: 0.5, maxWidth: 2000 })
 * // è®¡ç®—è¿‡ç¨‹ï¼š
 * // 1. åŸå§‹ç‰©ç†å®½åº¦: [1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840]
 * // 2. æŒ‰ ratio=0.5 ç¼©æ”¾: [800, 834, 960, 1024, 1280, 1440, 1728, 1920]
 * // 3. roundStep=16 å‘ä¸Šå–æ•´: [800, 848, 960, 1024, 1280, 1440, 1728, 1920]
 * // 4. å°é¡¶åˆ° maxWidth=2000: [800, 848, 960, 1024, 1280, 1440, 1728, 1920]
 * // 5. å¼ºåˆ¶æ·»åŠ  maxWidth=2000: [800, 848, 960, 1024, 1280, 1440, 1728, 1920, 2000]
 * // => { widths: [800, 848, 960, 1024, 1280, 1440, 1728, 1920, 2000] }
 * ```
 */
export function computeDesktopBreakpoints(opts: BreakpointOptions = {}): BreakpointResult {
  return computeBreakpointsInternal(opts, DESKTOP_PHYSICAL, DESKTOP_DESIGN_VIEWPORT_WIDTH);
}

/**
 * è®¡ç®— Mobile ç«™ç‚¹çš„å“åº”å¼å›¾ç‰‡æ–­ç‚¹
 *
 * @remarks
 * Mobile ç«™ç‚¹è¦†ç›– **Mobile** è®¾å¤‡
 * - ç‰©ç†å®½åº¦èŒƒå›´ï¼š1080px - 1320px
 * - å…± 3 ä¸ªç¦»æ•£æ–­ç‚¹ï¼ˆå–æ•´åï¼‰
 * - é»˜è®¤æœ€å¤§å®½åº¦ï¼š1320px
 *
 * **å‡½æ•°é‡è½½é€»è¾‘**ï¼š
 * 1. ä¸ä¼  ratioï¼šé»˜è®¤ 100vwï¼Œæˆ–ä» maxWidth åæ¨ ratio
 * 2. ä¼ é€’ ratioï¼šæŒ‰æŒ‡å®šæ¯”ä¾‹è®¡ç®—æ–­ç‚¹
 *
 * @param opts - æ–­ç‚¹é…ç½®é€‰é¡¹
 * @returns æ–­ç‚¹è®¡ç®—ç»“æœï¼ˆwidths æ•°ç»„ï¼‰
 *
 * @throws {Error} å½“ maxWidth < minWidth æ—¶
 * @throws {Error} å½“çº¦æŸæ¡ä»¶å¯¼è‡´æ— æœ‰æ•ˆæ–­ç‚¹æ—¶
 *
 * @example å…¨å®½ Mobile Hero
 * ```ts
 * const mobileHero = computeMobileBreakpoints({})
 * // è®¡ç®—è¿‡ç¨‹ï¼š
 * // 1. åŸå§‹ç‰©ç†å®½åº¦ï¼ˆMOBILE_PHYSICALï¼‰: [1080, 1206, 1320]
 * // 2. æŒ‰ ratio=1.0 ç¼©æ”¾: [1080, 1206, 1320]
 * // 3. roundStep=16 å‘ä¸Šå–æ•´: [1088, 1216, 1328]
 * // 4. å°é¡¶åˆ° maxWidth=1320: [1088, 1216, 1320]
 * // => { widths: [1088, 1216, 1320] }
 * ```
 *
 * @example 30% å®½ Mobile å¡ç‰‡
 * ```ts
 * const mobileCard = computeMobileBreakpoints({ ratio: 0.3 })
 * // è®¡ç®—è¿‡ç¨‹ï¼š
 * // 1. åŸå§‹ç‰©ç†å®½åº¦: [1080, 1206, 1320]
 * // 2. æŒ‰ ratio=0.3 ç¼©æ”¾: [324, 361.8, 396]
 * // 3. roundStep=16 å‘ä¸Šå–æ•´: [336, 368, 400]
 * // 4. å°é¡¶åˆ° upper=396: [336, 368, 396]
 * // => { widths: [336, 368, 396] }
 * ```
 *
 * @example å›ºå®šå°ºå¯¸ Mobile å¤´åƒ
 * ```ts
 * const mobileAvatar = computeMobileBreakpoints({ minWidth: 30, maxWidth: 100, roundStep: 1 })
 * // è®¡ç®—è¿‡ç¨‹ï¼š
 * // 1. åæ¨ ratio = 100 / 1320 â‰ˆ 0.076
 * // 2. åŸå§‹ç‰©ç†å®½åº¦: [1080, 1206, 1320]
 * // 3. æŒ‰ ratio=0.076 ç¼©æ”¾: [82.1, 91.7, 100.3]
 * // 4. roundStep=1 å‘ä¸Šå–æ•´: [83, 92, 101]
 * // 5. å°é¡¶åˆ° maxWidth=100: [83, 92, 100]
 * // 6. è¿‡æ»¤ minWidth=30: [83, 92, 100]ï¼ˆéƒ½ >= 30ï¼‰
 * // 7. å¼ºåˆ¶æ·»åŠ  minWidth=30 å’Œ maxWidth=100: [30, 83, 92, 100]
 * // => { widths: [30, 83, 92, 100] }
 * ```
 */
export function computeMobileBreakpoints(opts: BreakpointOptions = {}): BreakpointResult {
  return computeBreakpointsInternal(opts, MOBILE_PHYSICAL, MOBILE_DESIGN_VIEWPORT_WIDTH);
}

/**
 * å†…éƒ¨å®ç°å‡½æ•°ï¼ˆç»Ÿä¸€å¤„ç† Desktop å’Œ Mobile çš„æ–­ç‚¹è®¡ç®—é€»è¾‘ï¼‰
 *
 * @param opts - æ–­ç‚¹é…ç½®é€‰é¡¹
 * @param physicalList - è®¾å¤‡ç‰©ç†å®½åº¦æ•°ç»„ï¼ˆDesktop æˆ– Mobileï¼‰
 * @param defaultDesignViewportWidth - é»˜è®¤è®¾è®¡ç¨¿è§†å£å®½åº¦ï¼ˆDesktop: 3840, Mobile: 1320ï¼‰
 * @returns æ–­ç‚¹è®¡ç®—ç»“æœ
 *
 * @internal
 */
function computeBreakpointsInternal(
  opts: BreakpointOptions,
  physicalList: readonly number[],
  defaultDesignViewportWidth: number
): BreakpointResult {
  const { minWidth, maxWidth, roundStep = 16, designViewportWidth } = opts;

  // ä½¿ç”¨ç”¨æˆ·æä¾›çš„ designViewportWidthï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤å€¼
  const actualDesignViewportWidth = designViewportWidth ?? defaultDesignViewportWidth;

  // ============================================================
  // Step 1: å‚æ•°æ ¡éªŒ
  // ============================================================

  // æ ¡éªŒ 1: maxWidth >= minWidth
  if (maxWidth !== undefined && minWidth !== undefined && maxWidth < minWidth) {
    throw new Error(
      `[computeBreakpoints] maxWidth (${maxWidth}) must be greater than or equal to minWidth (${minWidth})`
    );
  }

  // æ ¡éªŒ 2: maxWidth <= designViewportWidth
  if (maxWidth !== undefined && maxWidth > actualDesignViewportWidth) {
    throw new Error(
      `[computeBreakpoints] maxWidth (${maxWidth}) must not exceed designViewportWidth (${actualDesignViewportWidth}). ` +
        `The image width cannot be larger than the design viewport width.`
    );
  }

  // ============================================================
  // Step 2: ç¡®å®š ratio å’Œæœ€å¤§å®½åº¦ä¸Šé™
  // ============================================================

  let ratio: number;
  let upper: number;

  if ("ratio" in opts && typeof opts.ratio === "number") {
    // åœºæ™¯ 1: ä¼ é€’äº† ratio å‚æ•°
    ratio = opts.ratio;

    // æœ€å¤§å®½åº¦ï¼šä¼˜å…ˆä½¿ç”¨ maxWidthï¼Œå¦åˆ™æŒ‰æ¯”ä¾‹è®¡ç®—ï¼Œä½†ä¸è¶…è¿‡ actualDesignViewportWidth
    if (maxWidth !== undefined) {
      upper = maxWidth;
    } else {
      upper = Math.min(actualDesignViewportWidth * ratio, actualDesignViewportWidth);
    }
  } else if (maxWidth !== undefined) {
    // åœºæ™¯ 2: æ²¡ä¼  ratioï¼Œä½†ä¼ äº† maxWidth â†’ ä» actualDesignViewportWidth åæ¨ ratio
    // æ³¨æ„ï¼šæ­¤æ—¶ maxWidth å·²ç»é€šè¿‡ Step 1 çš„æ ¡éªŒï¼Œç¡®ä¿ maxWidth <= actualDesignViewportWidth

    ratio = maxWidth / actualDesignViewportWidth;
    upper = maxWidth;
  } else {
    // åœºæ™¯ 3: éƒ½æ²¡ä¼  â†’ é»˜è®¤ 100% å®½åº¦
    ratio = 1.0;
    upper = actualDesignViewportWidth;
  }

  // é‡è¦ï¼šç¡®ä¿ upper æ˜¯æ•´æ•°ï¼ˆå‘ä¸‹å–æ•´ï¼Œé¿å…æ–­ç‚¹æ•°ç»„ä¸­å‡ºç°å°æ•°ï¼‰
  // ä¾‹å¦‚ï¼šratio=0.01 æ—¶ï¼Œ3840 Ã— 0.01 = 38.4ï¼Œåº”è¯¥å‘ä¸‹å–æ•´åˆ° 38
  // è¿™æ˜¯ä¸€ä¸ªå…³é”®çš„ bug ä¿®å¤ï¼Œç¡®ä¿æ‰€æœ‰æ–­ç‚¹éƒ½æ˜¯æ•´æ•°åƒç´ å€¼
  upper = Math.floor(upper);

  // ============================================================
  // Step 3: è®¡ç®—ç›®æ ‡ç‰©ç†å®½åº¦ï¼ˆæŒ‰ ratio ç¼©æ”¾ï¼‰
  // ============================================================

  const targetPhysical = physicalList.map((w) => w * ratio);

  // ============================================================
  // Step 4: åº”ç”¨çº¦æŸã€å–æ•´ã€å»é‡
  // ============================================================

  const uniq = new Set<number>();

  for (const w of targetPhysical) {
    // 4.1 å‘ä¸Šå–æ•´åˆ° roundStep çš„å€æ•°
    const rounded = Math.max(1, ceilToStep(w, roundStep));

    // 4.2 å°é¡¶åˆ°æœ€å¤§å®½åº¦
    // é‡è¦ï¼šç¡®ä¿æ–­ç‚¹ä¸è¶…è¿‡ç”¨æˆ·æŒ‡å®šçš„æœ€å¤§å®½åº¦ï¼ˆå› ä¸ºå–æ•´å¯èƒ½è¶…è¿‡ upperï¼‰
    const final = Math.min(rounded, upper);

    // 4.3 åº”ç”¨æœ€å°å®½åº¦çº¦æŸï¼ˆåœ¨å–æ•´åè¿‡æ»¤ï¼Œç¡®ä¿å–æ•´åçš„å€¼ >= minWidthï¼‰
    if (minWidth !== undefined && final < minWidth) {
      continue; // è·³è¿‡æ­¤æ–­ç‚¹
    }

    // 4.4 å»é‡ï¼ˆä½¿ç”¨ Set è‡ªåŠ¨å»é‡ï¼‰
    uniq.add(final);
  }

  // ============================================================
  // Step 5: å¼ºåˆ¶åŒ…å«ç”¨æˆ·æŒ‡å®šçš„å…³é”®æ–­ç‚¹
  // ============================================================

  // å¦‚æœç”¨æˆ·æ˜ç¡®æŒ‡å®šäº† minWidthï¼Œå°†å…¶ä½œä¸ºå…³é”®æ–­ç‚¹æ·»åŠ åˆ°ç»“æœä¸­
  // åŸå› ï¼šç”¨æˆ·æŒ‡å®šçš„æœ€å°å®½åº¦é€šå¸¸æ˜¯å…¶ä¸šåŠ¡åœºæ™¯ä¸­çš„é‡è¦å°ºå¯¸
  // æ³¨æ„ï¼šSet ä¼šè‡ªåŠ¨å»é‡ï¼Œå³ä½¿ minWidth å·²å­˜åœ¨ä¹Ÿä¸ä¼šé‡å¤æ·»åŠ 
  if (minWidth !== undefined) {
    uniq.add(minWidth);
  }

  // å¦‚æœç”¨æˆ·æ˜ç¡®æŒ‡å®šäº† maxWidthï¼Œå°†å…¶ä½œä¸ºå…³é”®æ–­ç‚¹æ·»åŠ åˆ°ç»“æœä¸­
  // åŸå› ï¼šç”¨æˆ·æŒ‡å®šçš„æœ€å¤§å®½åº¦é€šå¸¸æ˜¯å…¶ä¸šåŠ¡åœºæ™¯ä¸­çš„é‡è¦å°ºå¯¸
  // æ³¨æ„ï¼šSet ä¼šè‡ªåŠ¨å»é‡ï¼Œå³ä½¿ maxWidth å·²å­˜åœ¨ä¹Ÿä¸ä¼šé‡å¤æ·»åŠ 
  if (maxWidth !== undefined) {
    uniq.add(maxWidth);
  }

  // ============================================================
  // Step 6: æ’åºå¹¶è½¬æ¢ä¸ºæ•°ç»„
  // ============================================================

  const final = Array.from(uniq).sort((a, b) => a - b);

  // ============================================================
  // Step 7: é”™è¯¯æ£€æŸ¥ï¼ˆçº¦æŸåæ— æœ‰æ•ˆæ–­ç‚¹ï¼‰
  // ============================================================

  if (final.length === 0) {
    throw new Error(
      `[computeBreakpoints] No valid breakpoints generated with current constraints. Please check parameters:\n` +
        `  - ratio: ${"ratio" in opts ? opts.ratio : "not provided (default 1.0)"}\n` +
        `  - maxWidth: ${maxWidth ?? defaultMaxWidth} (${maxWidth === undefined ? "default" : "provided"})\n` +
        `  - minWidth: ${minWidth ?? "none"} (${minWidth === undefined ? "default" : "provided"})\n` +
        `  - roundStep: ${roundStep}\n` +
        `Hint: minWidth may be too large, or maxWidth may be too small`
    );
  }

  // ============================================================
  // Step 8: è¿”å›ç»“æœ
  // ============================================================

  return { widths: final };
}
````

---

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```ts
// ============================================================
// Desktop ç«™ç‚¹ç¤ºä¾‹
// ============================================================

// ç¤ºä¾‹ 1: å…¨å®½ Hero Bannerï¼ˆæœ€å¤§ 3840pxï¼‰
const heroDesktop = computeDesktopBreakpoints({});
// => { widths: [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840] }

// ç¤ºä¾‹ 2: 30% å®½å¡ç‰‡ç¼©ç•¥å›¾
const cardDesktop = computeDesktopBreakpoints({ ratio: 0.3 });
// => { widths: [480, 512, 576, 624, 768, 864, 1040, 1152] }

// ç¤ºä¾‹ 3: æœ€å¤§å®½åº¦ 1500pxï¼ˆè‡ªåŠ¨åæ¨ ratio â‰ˆ 0.39ï¼‰
const mediumDesktop = computeDesktopBreakpoints({ maxWidth: 1500 });
// å†…éƒ¨è®¡ç®—: ratio = 1500 / 3840 â‰ˆ 0.391
// => { widths: [640, 656, 752, 816, 1008, 1136, 1360, 1500] }

// ç¤ºä¾‹ 4: 50% å®½ä¾§æ å›¾ç‰‡ï¼Œæœ€å¤§ 2000px
const sidebarDesktop = computeDesktopBreakpoints({
  ratio: 0.5,
  maxWidth: 2000,
});
// => { widths: [800, 848, 960, 1024, 1280, 1440, 1728, 1920, 2000] }
// æ³¨æ„ï¼š2000 ä½œä¸ºç”¨æˆ·æŒ‡å®šçš„ maxWidthï¼Œå¿…å®šå‡ºç°åœ¨ç»“æœä¸­

// ç¤ºä¾‹ 5: å“åº”å¼äº§å“ç¼©ç•¥å›¾ï¼ˆæ˜¾å¼ ratio + å°ºå¯¸èŒƒå›´ï¼‰
const productThumb = computeDesktopBreakpoints({
  ratio: 0.25,
  minWidth: 300,
  maxWidth: 800,
});
// => { widths: [300, 400, 432, 480, 512, 640, 720, 800] }
// æ³¨æ„ï¼š300 å’Œ 800 ä½œä¸ºç”¨æˆ·æŒ‡å®šçš„å…³é”®æ–­ç‚¹ï¼Œå¿…å®šå‡ºç°åœ¨ç»“æœä¸­

// ç¤ºä¾‹ 6: å¤´åƒå›¾ç‰‡ï¼ˆ30-100pxï¼‰
const avatarDesktop = computeDesktopBreakpoints({
  minWidth: 30,
  maxWidth: 100,
  roundStep: 1,
});
// å†…éƒ¨è®¡ç®—: ratio = 100 / 3840 â‰ˆ 0.026
// => { widths: [30, 42, 44, 50, 54, 67, 75, 90, 100] }
// æ³¨æ„ï¼š30 å’Œ 100 ä½œä¸ºç”¨æˆ·æŒ‡å®šçš„å…³é”®æ–­ç‚¹ï¼Œå¿…å®šå‡ºç°åœ¨ç»“æœä¸­

// ç¤ºä¾‹ 7: è‡ªå®šä¹‰å–æ•´æ­¥è¿›
const customStep = computeDesktopBreakpoints({
  ratio: 0.3,
  roundStep: 8,
});
// => { widths: [480, 504, 576, 616, 768, 864, 1040, 1152] }
// æ³¨ï¼š1668 Ã— 0.3 = 500.4 â†’ å‘ä¸Šå–æ•´åˆ° 8 çš„å€æ•° = 504

// ç¤ºä¾‹ 8: æ”¯æŒ 5K æ˜¾ç¤ºå™¨ï¼ˆiMac 5K, Pro Display XDR @Retinaï¼‰
const hero5K = computeDesktopBreakpoints({ designViewportWidth: 5120 });
// => { widths: [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840, 5120] }
// æ³¨ï¼šåŒ…å« 5120px æ–­ç‚¹ï¼Œå¯ä¸º 5K æ˜¾ç¤ºå™¨æä¾›åŸç”Ÿåˆ†è¾¨ç‡å›¾ç‰‡

// ç¤ºä¾‹ 9: æ”¯æŒ 6K æ˜¾ç¤ºå™¨ï¼ˆPro Display XDR Nativeï¼‰
const hero6K = computeDesktopBreakpoints({ designViewportWidth: 6016 });
// => { widths: [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840, 5120, 6016] }
// æ³¨ï¼šåŒ…å«å®Œæ•´çš„ 10 ä¸ªæ–­ç‚¹ï¼Œè¦†ç›–æ‰€æœ‰è®¾å¤‡

// ç¤ºä¾‹ 10: 5K æ˜¾ç¤ºå™¨ + 30% å®½å¡ç‰‡
const card5K = computeDesktopBreakpoints({
  ratio: 0.3,
  designViewportWidth: 5120,
});
// => { widths: [480, 512, 576, 624, 768, 864, 1040, 1152, 1536] }
// æ³¨ï¼š5120 Ã— 0.3 = 1536ï¼Œè‡ªåŠ¨åŒ…å«æ›´å¤§çš„æ–­ç‚¹

// ============================================================
// Mobile ç«™ç‚¹ç¤ºä¾‹
// ============================================================

// ç¤ºä¾‹ 11: å…¨å®½ Mobile Hero Banner
const heroMobile = computeMobileBreakpoints({});
// => { widths: [1088, 1216, 1320] }
// æ³¨ï¼š1080 â†’ 1088, 1206 â†’ 1216, 1328 å°é¡¶åˆ° 1320

// ç¤ºä¾‹ 12: 30% å®½ Mobile å¡ç‰‡ç¼©ç•¥å›¾
const cardMobile = computeMobileBreakpoints({ ratio: 0.3 });
// => { widths: [336, 368, 396] }
// è®¡ç®—è¿‡ç¨‹:
// - 1080 Ã— 0.3 = 324 â†’ å‘ä¸Šå–æ•´ = 336
// - 1206 Ã— 0.3 = 361.8 â†’ å‘ä¸Šå–æ•´ = 368
// - 1320 Ã— 0.3 = 396 â†’ å‘ä¸Šå–æ•´ = 400 â†’ å°é¡¶åˆ° 396

// ç¤ºä¾‹ 13: Mobile å¤´åƒï¼ˆ30-100pxï¼‰
const avatarMobile = computeMobileBreakpoints({
  minWidth: 30,
  maxWidth: 100,
  roundStep: 1,
});
// å†…éƒ¨è®¡ç®—: ratio = 100 / 1320 â‰ˆ 0.076
// => { widths: [30, 83, 92, 100] }
// è®¡ç®—è¿‡ç¨‹:
// - 1080 Ã— 0.076 â‰ˆ 82.1 â†’ å‘ä¸Šå–æ•´åˆ°1 = 83
// - 1206 Ã— 0.076 â‰ˆ 91.7 â†’ å‘ä¸Šå–æ•´åˆ°1 = 92
// - 1320 Ã— 0.076 â‰ˆ 100.3 â†’ å‘ä¸Šå–æ•´åˆ°1 = 101 â†’ å°é¡¶åˆ°100
// - å¼ºåˆ¶æ·»åŠ  minWidth=30ï¼ˆä½œä¸ºå…³é”®æ–­ç‚¹ï¼‰
// æ³¨æ„ï¼š30 å’Œ 100 ä½œä¸ºç”¨æˆ·æŒ‡å®šçš„å…³é”®æ–­ç‚¹ï¼Œå¿…å®šå‡ºç°åœ¨ç»“æœä¸­

// ç¤ºä¾‹ 14: æœ€å¤§å®½åº¦ 800pxï¼ˆè‡ªåŠ¨åæ¨ ratioï¼‰
const mediumMobile = computeMobileBreakpoints({ maxWidth: 800 });
// å†…éƒ¨è®¡ç®—: ratio = 800 / 1320 â‰ˆ 0.606
// => { widths: [656, 736, 800] }

// ============================================================
// è¾¹ç•Œæƒ…å†µä¸é”™è¯¯å¤„ç†
// ============================================================

// ç¤ºä¾‹ 15: é”™è¯¯ - maxWidth < minWidth
try {
  computeDesktopBreakpoints({ minWidth: 2000, maxWidth: 1000 });
} catch (error) {
  console.error(error.message);
  // => [computeBreakpoints] maxWidth (1000) å¿…é¡»å¤§äºç­‰äº minWidth (2000)
}

// ç¤ºä¾‹ 16: é”™è¯¯ - çº¦æŸæ¡ä»¶å¯¼è‡´æ— æœ‰æ•ˆæ–­ç‚¹
try {
  computeDesktopBreakpoints({ minWidth: 5000, maxWidth: 6000 });
} catch (error) {
  console.error(error.message);
  // => [computeBreakpoints] æ ¹æ®å½“å‰çº¦æŸæ¡ä»¶æ— æ³•ç”Ÿæˆæœ‰æ•ˆæ–­ç‚¹...
}
```

---

**æ³¨é‡Šè¯´æ˜**ï¼š

1. **è®¾å¤‡çŸ©é˜µä¸é»˜è®¤è¡Œä¸º**ï¼š`DESKTOP_PHYSICAL` åŒ…å«å®Œæ•´çš„ 10 ä¸ªç‰©ç†å®½åº¦æ–­ç‚¹ï¼ˆ1600-6016ï¼‰ï¼Œä½†é»˜è®¤æƒ…å†µä¸‹ï¼ˆ`designViewportWidth=3840`ï¼‰ï¼Œæ–­ç‚¹ä¼šè¢«å°é¡¶åˆ° 3840ï¼Œå®é™…ä½¿ç”¨ 8 ä¸ªæ–­ç‚¹ã€‚è¿™æ ·æ—¢ä¿æŒäº†é»˜è®¤è¡Œä¸ºçš„é«˜æ•ˆæ€§ï¼Œåˆå…è®¸é€šè¿‡ `designViewportWidth` å‚æ•°çµæ´»æ”¯æŒ 5K/6K æ˜¾ç¤ºå™¨ã€‚

2. **å–æ•´è¡Œä¸º**ï¼š`DESKTOP_PHYSICAL` ä¸­çš„ 1668 åœ¨ `roundStep=16` æ—¶ä¼šå‘ä¸Šå–æ•´åˆ° 1680ã€‚å¦‚æœéœ€è¦ä¿ç•™åŸå€¼ï¼Œå¯è®¾ç½® `roundStep=1`ã€‚

3. **å›ºå®šå°ºå¯¸åœºæ™¯**ï¼šå¯¹äºå¤´åƒã€Logo ç­‰å›ºå®šå°ºå¯¸å›¾ç‰‡ï¼Œå»ºè®®ï¼š
   - è®¾ç½® `minWidth` å’Œ `maxWidth` ç›¸åŒï¼ˆå¦‚ `{ minWidth: 100, maxWidth: 100 }`ï¼‰
   - ä½¿ç”¨ `roundStep=1` é¿å…å–æ•´åå·®
   - æˆ–è€…ç›´æ¥ä¼ é€’ `maxWidth` è®©å‡½æ•°è‡ªåŠ¨åæ¨ `ratio`

4. **sizes å±æ€§è¯´æ˜**ï¼š`sizes` å±æ€§æè¿°å›¾ç‰‡çš„ **CSS æ˜¾ç¤ºå®½åº¦**ï¼Œåº”ç”±å¼€å‘è€…æ ¹æ®å®é™…çš„ CSS å¸ƒå±€æŒ‡å®šã€‚å·¥å…·å‡½æ•°åªç”Ÿæˆç‰©ç†åƒç´ æ–­ç‚¹ï¼ˆ`widths`ï¼‰ï¼Œä¸è‡ªåŠ¨ç”Ÿæˆ `sizes`ã€‚å¼€å‘è€…éœ€è¦æ ¹æ®å“åº”å¼å¸ƒå±€éœ€æ±‚æ‰‹åŠ¨æŒ‡å®šï¼Œä¾‹å¦‚ï¼š
   - å…¨å®½å›¾ç‰‡ï¼š`sizes="100vw"`
   - å›ºå®šæ¯”ä¾‹ï¼š`sizes="30vw"`
   - å¤æ‚å“åº”å¼ï¼š`sizes="(min-width: 1024px) 50vw, 100vw"`

5. **æ¨èå‚æ•°ç»„åˆ**ï¼š
   - **å…¨å®½å›¾ç‰‡**ï¼š`{}`ï¼ˆé»˜è®¤ï¼‰
   - **æŒ‰æ¯”ä¾‹å›¾ç‰‡**ï¼š`{ ratio: 0.3 }` æˆ– `{ ratio: 0.5 }`
   - **è‡ªåŠ¨æ¨æ–­**ï¼š`{ maxWidth: 1500 }` ï¼ˆè®©å‡½æ•°åæ¨ ratioï¼‰
   - **å›ºå®šå°ºå¯¸**ï¼š`{ minWidth: 100, maxWidth: 100, roundStep: 1 }`
   - **å¤§å›¾è¿‡æ»¤**ï¼š`{ minWidth: 800 }`ï¼ˆè¿‡æ»¤æ‰å°æ–­ç‚¹ï¼‰
   - **5K/6K æ˜¾ç¤ºå™¨**ï¼š`{ designViewportWidth: 5120 }` æˆ– `{ designViewportWidth: 6016 }`

---

## 5. æ–¹æ¡ˆå®ç°ï¼ˆä»£ç ä¸è¾“å‡ºï¼‰â€” åŒç«™ç‚¹ Ã— ä¸‰åœºæ™¯

> ä¸‹æ–‡é€šè¿‡ä¸‰ä¸ªå…¸å‹åœºæ™¯æ¼”ç¤ºå®Œæ•´çš„å®ç°æ–¹æ³•ã€‚ç¤ºä¾‹å‡ç»™å‡ºå®Œæ•´ `srcset`ï¼Œæ–‡ä»¶åä»…ç¤ºæ„ï¼ˆå®é™…æ„å»ºä¼šå¸¦ hashï¼‰ã€‚é«˜åº¦ä»¥ **16:9** ä¸¾ä¾‹ï¼ˆ2160 for 3840, 648 for 1152, etc.ï¼‰ï¼Œå®é™…é¡¹ç›®è¯·æŒ‰è®¾è®¡ç¨¿æ¯”ä¾‹è°ƒæ•´ã€‚

### 5.1 Desktop ç«™ç‚¹ï¼ˆè¦†ç›– Tablet + Laptop + Desktopï¼‰

#### æ¼”ç¤ºåœºæ™¯ 1ï¼šè§†å£ 100% å®½ï¼ˆå¦‚ Hero Bannerï¼‰

**è®¾è®¡äº¤ä»˜**ï¼š

- **åŸå›¾å°ºå¯¸**ï¼š16:9 â†’ **3840Ã—2160 JPEGï¼ˆsRGBï¼Œè´¨é‡ 90â€“95ï¼‰**
- **é 16:9**ï¼šå®½ 3840ã€é«˜æŒ‰æ¯”ä¾‹

**æ–­ç‚¹è®¡ç®—**ï¼š

```ts
const { widths } = computeDesktopBreakpoints({});
// è®¡ç®—è¿‡ç¨‹ï¼š
// 1. åŸå§‹ç‰©ç†å®½åº¦: [1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840]
// 2. roundStep=16 å–æ•´: [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840]
// widths: [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840]
```

**sizes å±æ€§è¯´æ˜**ï¼š

- `sizes` å±æ€§æè¿°å›¾ç‰‡çš„ **CSS æ˜¾ç¤ºå®½åº¦**ï¼Œåº”ç”±å¼€å‘è€…æ ¹æ®å®é™…å¸ƒå±€æŒ‡å®š
- å¯¹äºå…¨å®½å›¾ç‰‡ï¼Œä½¿ç”¨ `sizes="100vw"`

**Astro ç»„ä»¶ - `<Picture>`**ï¼š

```astro
---
import { Picture } from "astro:assets";
import hero from "../assets/hero-desktop.jpg";
const WIDTHS = [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840];
---

<Picture src={hero} alt="Hero banner" widths={WIDTHS} formats={["avif", "webp", "jpeg"]} sizes="100vw" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<picture>
  <source
    type="image/avif"
    srcset="
      /img/hero-1600.avif 1600w,
      /img/hero-1680.avif 1680w,
      /img/hero-1920.avif 1920w,
      /img/hero-2048.avif 2048w,
      /img/hero-2560.avif 2560w,
      /img/hero-2880.avif 2880w,
      /img/hero-3456.avif 3456w,
      /img/hero-3840.avif 3840w
    "
    sizes="100vw"
  />
  <source
    type="image/webp"
    srcset="
      /img/hero-1600.webp 1600w,
      /img/hero-1680.webp 1680w,
      /img/hero-1920.webp 1920w,
      /img/hero-2048.webp 2048w,
      /img/hero-2560.webp 2560w,
      /img/hero-2880.webp 2880w,
      /img/hero-3456.webp 3456w,
      /img/hero-3840.webp 3840w
    "
    sizes="100vw"
  />
  <img
    src="/img/hero-1920.jpeg"
    srcset="
      /img/hero-1600.jpeg 1600w,
      /img/hero-1680.jpeg 1680w,
      /img/hero-1920.jpeg 1920w,
      /img/hero-2048.jpeg 2048w,
      /img/hero-2560.jpeg 2560w,
      /img/hero-2880.jpeg 2880w,
      /img/hero-3456.jpeg 3456w,
      /img/hero-3840.jpeg 3840w
    "
    sizes="100vw"
    width="3840"
    height="2160"
    alt="Hero banner"
    loading="lazy"
    decoding="async"
  />
</picture>
```

**Astro ç»„ä»¶ - `<Image>`**ï¼š

```astro
---
import { Image } from "astro:assets";
import hero from "../assets/hero-desktop.jpg";
const WIDTHS = [1600, 1680, 1920, 2048, 2560, 2880, 3456, 3840];
---

<Image src={hero} alt="Hero banner" format="webp" widths={WIDTHS} sizes="100vw" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<img
  src="/img/hero-1920.webp"
  srcset="
    /img/hero-1600.webp 1600w,
    /img/hero-1680.webp 1680w,
    /img/hero-1920.webp 1920w,
    /img/hero-2048.webp 2048w,
    /img/hero-2560.webp 2560w,
    /img/hero-2880.webp 2880w,
    /img/hero-3456.webp 3456w,
    /img/hero-3840.webp 3840w
  "
  sizes="100vw"
  width="3840"
  height="2160"
  alt="Hero banner"
  loading="lazy"
  decoding="async"
/>
```

**è®¾å¤‡æ˜ å°„è¡¨ï¼ˆDesktop ç«™ç‚¹ - 100% å®½ï¼‰**ï¼š

| è®¾å¤‡åˆ†ç±»           | Device ID           | Physical Width | CSS Width | æµè§ˆå™¨é€‰æ‹©ï¼ˆPicture/AVIFï¼‰ | æµè§ˆå™¨é€‰æ‹©ï¼ˆImage/WebPï¼‰ |
| ------------------ | ------------------- | -------------: | --------: | -------------------------- | ------------------------ |
| Tablet S           | `tablet-small`      |           1600 |       533 | `hero-1600.avif`           | `hero-1600.webp`         |
| Tablet M           | `tablet-medium`     |           1668 |       834 | `hero-1680.avif`           | `hero-1680.webp`         |
| Tablet L           | `tablet-large`      |           2048 |      1024 | `hero-2048.avif`           | `hero-2048.webp`         |
| Laptop S           | `laptop-small`      |           1920 | 1280-1920 | `hero-1920.avif`           | `hero-1920.webp`         |
| Laptop M           | `laptop-medium`     |           2560 | 1280-1664 | `hero-2560.avif`           | `hero-2560.webp`         |
| Laptop L           | `laptop-large`      |           2880 | 1440-1512 | `hero-2880.avif`           | `hero-2880.webp`         |
| Laptop XL          | `laptop-xlarge`     |           3456 |      1728 | `hero-3456.avif`           | `hero-3456.webp`         |
| Desktop 2K         | `desktop-2k`        |           2560 |      2560 | `hero-2560.avif`           | `hero-2560.webp`         |
| Desktop 4K         | `desktop-4k`        |           3840 |      3840 | `hero-3840.avif`           | `hero-3840.webp`         |
| Desktop 4K @1.5x   | `desktop-4k-1.5x`   |           3840 |      2560 | `hero-3840.avif`           | `hero-3840.webp`         |
| Desktop 4K @Retina | `desktop-4k-retina` |      5120â†’3840 |      2560 | `hero-3840.avif`           | `hero-3840.webp`         |
| Desktop 6K         | `desktop-6k`        |      6016â†’3840 |      6016 | `hero-3840.avif`           | `hero-3840.webp`         |

**æ³¨**ï¼š

- æµè§ˆå™¨æ ¹æ® `sizes="100vw"` å’Œå½“å‰è§†å£å®½åº¦ï¼Œä» `srcset` ä¸­é€‰æ‹©æœ€æ¥è¿‘ä¸”ä¸å°äºéœ€è¦å®½åº¦çš„å€™é€‰
- æœ¬æ¼”ç¤ºåœºæ™¯ä¸­ï¼Œå›¾ç‰‡åœ¨ 3840 è®¾è®¡ç¨¿ä¸­ä¸ºå…¨å®½ï¼ˆ3840pxï¼‰ï¼Œå› æ­¤æœ€å¤§å¯¼å‡º 3840 å®½åº¦çš„å›¾ç‰‡
- Desktop 4K @Retina å’Œ Desktop 6K è™½ç„¶ç‰©ç†å®½åº¦æ›´å¤§ï¼ˆ5120/6016ï¼‰ï¼Œä½†ç”±äºè®¾è®¡ç¨¿åŸºå‡†ä¸º 3840ï¼Œæ‰€ä»¥é€‰æ‹© 3840.avif
- Tablet M (1668px) ä¼šé€‰æ‹© 1680.avifï¼ˆå‘ä¸Šå–æ•´çš„ç»“æœï¼‰

---

#### æ¼”ç¤ºåœºæ™¯ 2ï¼šè§†å£ 30% å®½ï¼ˆå¦‚å¡ç‰‡ç¼©ç•¥å›¾ï¼‰

**è®¾è®¡äº¤ä»˜**ï¼š

- **åŸå›¾å°ºå¯¸**ï¼š16:9 â†’ **1152Ã—648 JPEGï¼ˆsRGBï¼Œè´¨é‡ 90â€“95ï¼‰**
- **é 16:9**ï¼šå®½ 1152ã€é«˜æŒ‰æ¯”ä¾‹

**æ–­ç‚¹è®¡ç®—**ï¼š

```ts
const { widths } = computeDesktopBreakpoints({ ratio: 0.3 });
// è®¡ç®—è¿‡ç¨‹ï¼š
// 1. åŸå§‹ç‰©ç†å®½åº¦: [1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840]
// 2. æŒ‰ ratio=0.3 ç¼©æ”¾: [480, 500.4, 576, 614.4, 768, 864, 1036.8, 1152]
// 3. roundStep=16 å–æ•´: [480, 512, 576, 624, 768, 864, 1040, 1152]
// widths: [480, 512, 576, 624, 768, 864, 1040, 1152]
```

**sizes å±æ€§è¯´æ˜**ï¼š

- å¯¹äºå è§†å£ 30% å®½åº¦çš„å›¾ç‰‡ï¼Œä½¿ç”¨ `sizes="30vw"`

**Astro ç»„ä»¶ - `<Picture>`**ï¼š

```astro
---
import { Picture } from "astro:assets";
import card from "../assets/card-desktop.jpg";
const WIDTHS = [480, 512, 576, 624, 768, 864, 1040, 1152];
---

<Picture src={card} alt="Card thumbnail" widths={WIDTHS} formats={["avif", "webp", "jpeg"]} sizes="30vw" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<picture>
  <source
    type="image/avif"
    srcset="
      /img/card-480.avif   480w,
      /img/card-512.avif   512w,
      /img/card-576.avif   576w,
      /img/card-624.avif   624w,
      /img/card-768.avif   768w,
      /img/card-864.avif   864w,
      /img/card-1040.avif 1040w,
      /img/card-1152.avif 1152w
    "
    sizes="30vw"
  />
  <source
    type="image/webp"
    srcset="
      /img/card-480.webp   480w,
      /img/card-512.webp   512w,
      /img/card-576.webp   576w,
      /img/card-624.webp   624w,
      /img/card-768.webp   768w,
      /img/card-864.webp   864w,
      /img/card-1040.webp 1040w,
      /img/card-1152.webp 1152w
    "
    sizes="30vw"
  />
  <img
    src="/img/card-576.jpeg"
    srcset="
      /img/card-480.jpeg   480w,
      /img/card-512.jpeg   512w,
      /img/card-576.jpeg   576w,
      /img/card-624.jpeg   624w,
      /img/card-768.jpeg   768w,
      /img/card-864.jpeg   864w,
      /img/card-1040.jpeg 1040w,
      /img/card-1152.jpeg 1152w
    "
    sizes="30vw"
    width="1152"
    height="648"
    alt="Card thumbnail"
    loading="lazy"
    decoding="async"
  />
</picture>
```

**Astro ç»„ä»¶ - `<Image>`**ï¼š

```astro
---
import { Image } from "astro:assets";
import card from "../assets/card-desktop.jpg";
const WIDTHS = [480, 512, 576, 624, 768, 864, 1040, 1152];
---

<Image src={card} alt="Card thumbnail" format="webp" widths={WIDTHS} sizes="30vw" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<img
  src="/img/card-576.webp"
  srcset="
    /img/card-480.webp   480w,
    /img/card-512.webp   512w,
    /img/card-576.webp   576w,
    /img/card-624.webp   624w,
    /img/card-768.webp   768w,
    /img/card-864.webp   864w,
    /img/card-1040.webp 1040w,
    /img/card-1152.webp 1152w
  "
  sizes="30vw"
  width="1152"
  height="648"
  alt="Card thumbnail"
  loading="lazy"
  decoding="async"
/>
```

**è®¾å¤‡æ˜ å°„è¡¨ï¼ˆDesktop ç«™ç‚¹ - 30% å®½ï¼‰**ï¼š

| è®¾å¤‡åˆ†ç±»           | Device ID           | Physical Width | CSS Width | æµè§ˆå™¨é€‰æ‹©ï¼ˆPicture/AVIFï¼‰ | æµè§ˆå™¨é€‰æ‹©ï¼ˆImage/WebPï¼‰ |
| ------------------ | ------------------- | -------------: | --------: | -------------------------- | ------------------------ |
| Tablet S           | `tablet-small`      |           1600 |       533 | `card-480.avif`            | `card-480.webp`          |
| Tablet M           | `tablet-medium`     |           1668 |       834 | `card-512.avif`            | `card-512.webp`          |
| Tablet L           | `tablet-large`      |           2048 |      1024 | `card-624.avif`            | `card-624.webp`          |
| Laptop S           | `laptop-small`      |           1920 | 1280-1920 | `card-576.avif`            | `card-576.webp`          |
| Laptop M           | `laptop-medium`     |           2560 | 1280-1664 | `card-768.avif`            | `card-768.webp`          |
| Laptop L           | `laptop-large`      |           2880 | 1440-1512 | `card-864.avif`            | `card-864.webp`          |
| Laptop XL          | `laptop-xlarge`     |           3456 |      1728 | `card-1040.avif`           | `card-1040.webp`         |
| Desktop 2K         | `desktop-2k`        |           2560 |      2560 | `card-768.avif`            | `card-768.webp`          |
| Desktop 4K         | `desktop-4k`        |           3840 |      3840 | `card-1152.avif`           | `card-1152.webp`         |
| Desktop 4K @1.5x   | `desktop-4k-1.5x`   |           3840 |      2560 | `card-1152.avif`           | `card-1152.webp`         |
| Desktop 4K @Retina | `desktop-4k-retina` |      5120â†’3840 |      2560 | `card-1152.avif`           | `card-1152.webp`         |
| Desktop 6K         | `desktop-6k`        |      6016â†’3840 |      6016 | `card-1152.avif`           | `card-1152.webp`         |

**è®¡ç®—è¯´æ˜**ï¼š

- æµè§ˆå™¨æ ¹æ® `sizes="30vw"` è®¡ç®—å®é™…æ˜¾ç¤ºå®½åº¦ = è§†å£å®½åº¦ Ã— 0.3
- å¦‚ Tablet M (CSS 834px)ï¼šæ˜¾ç¤ºå®½åº¦ = 834 Ã— 0.3 Ã— 2 (DPR) â‰ˆ 500px â†’ é€‰æ‹© 512.avif
- å¦‚ Desktop 4K (CSS 3840px)ï¼šæ˜¾ç¤ºå®½åº¦ = 3840 Ã— 0.3 Ã— 1 (DPR) = 1152px â†’ é€‰æ‹© 1152.avif

---

#### æ¼”ç¤ºåœºæ™¯ 3ï¼šå›ºå®šå°ºå¯¸ 30â€“100pxï¼ˆå¦‚å¤´åƒ/å›¾æ ‡ï¼‰

**è®¾è®¡äº¤ä»˜**ï¼š

- **åŸå›¾å°ºå¯¸**ï¼š**100Ã—100 PNG**ï¼ˆæˆ–æ— æŸ WebPï¼›æ‘„å½±å¤´åƒå¯ç”¨ JPEG 90â€“95ï¼‰

**æ–­ç‚¹è®¡ç®—**ï¼š

```ts
const { widths } = computeDesktopBreakpoints({
  minWidth: 30,
  maxWidth: 100,
  roundStep: 1,
});
// è®¡ç®—è¿‡ç¨‹ï¼š
// 1. åæ¨ ratio = 100 / 3840 â‰ˆ 0.026
// 2. åŸå§‹ç‰©ç†å®½åº¦: [1600, 1668, 1920, 2048, 2560, 2880, 3456, 3840]
// 3. æŒ‰ ratio=0.026 ç¼©æ”¾: [41.6, 43.4, 50.0, 53.2, 66.6, 74.9, 89.9, 100.0]
// 4. roundStep=1 å–æ•´: [42, 44, 50, 54, 67, 75, 90, 100]
// 5. å¼ºåˆ¶æ·»åŠ  minWidth=30: [30, 42, 44, 50, 54, 67, 75, 90, 100]
// widths: [30, 42, 44, 50, 54, 67, 75, 90, 100]
```

**sizes å±æ€§è¯´æ˜**ï¼š

- æœ¬åœºæ™¯ä½¿ç”¨**å›ºå®š CSS å°ºå¯¸** `25px` æ¥æ¼”ç¤ºå“åº”å¼ä¼˜åŒ–çš„æ ¸å¿ƒä»·å€¼
- å³ä½¿å¼€å‘è€…åªæŒ‡å®šäº†ä¸€ä¸ªå›ºå®šçš„ CSS å°ºå¯¸ï¼Œç»„ä»¶ä¹Ÿä¼šæ ¹æ®ä¸åŒè®¾å¤‡çš„ **DPR** è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„ç‰©ç†åˆ†è¾¨ç‡å›¾ç‰‡
- è¿™æ ·æ— éœ€ç¼–å†™å¤æ‚çš„å“åº”å¼é€»è¾‘ï¼Œç»„ä»¶ä¼šè‡ªåŠ¨ä¸º DPR=1/1.5/2/3 çš„è®¾å¤‡æä¾› 30/42/50/75 ç­‰ä¸åŒç‰©ç†åˆ†è¾¨ç‡çš„å›¾ç‰‡

**Astro ç»„ä»¶ - `<Picture>`**ï¼š

```astro
---
import { Picture } from "astro:assets";
import avatar from "../assets/avatar.png";
const WIDTHS = [30, 42, 44, 50, 54, 67, 75, 90, 100];
---

<Picture src={avatar} alt="User avatar" widths={WIDTHS} formats={["avif", "webp", "png"]} sizes="25px" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<picture>
  <source
    type="image/avif"
    srcset="
      /img/avatar-30.avif   30w,
      /img/avatar-42.avif   42w,
      /img/avatar-44.avif   44w,
      /img/avatar-50.avif   50w,
      /img/avatar-54.avif   54w,
      /img/avatar-67.avif   67w,
      /img/avatar-75.avif   75w,
      /img/avatar-90.avif   90w,
      /img/avatar-100.avif 100w
    "
    sizes="25px"
  />
  <source
    type="image/webp"
    srcset="
      /img/avatar-30.webp   30w,
      /img/avatar-42.webp   42w,
      /img/avatar-44.webp   44w,
      /img/avatar-50.webp   50w,
      /img/avatar-54.webp   54w,
      /img/avatar-67.webp   67w,
      /img/avatar-75.webp   75w,
      /img/avatar-90.webp   90w,
      /img/avatar-100.webp 100w
    "
    sizes="25px"
  />
  <img
    src="/img/avatar-50.png"
    srcset="
      /img/avatar-30.png   30w,
      /img/avatar-42.png   42w,
      /img/avatar-44.png   44w,
      /img/avatar-50.png   50w,
      /img/avatar-54.png   54w,
      /img/avatar-67.png   67w,
      /img/avatar-75.png   75w,
      /img/avatar-90.png   90w,
      /img/avatar-100.png 100w
    "
    sizes="25px"
    width="100"
    height="100"
    alt="User avatar"
    loading="lazy"
    decoding="async"
  />
</picture>
```

**Astro ç»„ä»¶ - `<Image>`**ï¼š

```astro
---
import { Image } from "astro:assets";
import avatar from "../assets/avatar.png";
const WIDTHS = [30, 42, 44, 50, 54, 67, 75, 90, 100];
---

<Image src={avatar} alt="User avatar" format="webp" widths={WIDTHS} sizes="25px" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<img
  src="/img/avatar-50.webp"
  srcset="
    /img/avatar-30.webp   30w,
    /img/avatar-42.webp   42w,
    /img/avatar-44.webp   44w,
    /img/avatar-50.webp   50w,
    /img/avatar-54.webp   54w,
    /img/avatar-67.webp   67w,
    /img/avatar-75.webp   75w,
    /img/avatar-90.webp   90w,
    /img/avatar-100.webp 100w
  "
  sizes="25px"
  width="100"
  height="100"
  alt="User avatar"
  loading="lazy"
  decoding="async"
/>
```

**è®¾å¤‡æ˜ å°„è¡¨ï¼ˆDesktop ç«™ç‚¹ - æ–¹å½¢ 30â€“100ï¼‰**ï¼š

| è®¾å¤‡åˆ†ç±»           | Device ID           | Physical Width | CSS Width | DPR | éœ€è¦å®½åº¦ (25px Ã— DPR) | æµè§ˆå™¨é€‰æ‹©ï¼ˆPicture/AVIFï¼‰ | æµè§ˆå™¨é€‰æ‹©ï¼ˆImage/WebPï¼‰ |
| ------------------ | ------------------- | -------------: | --------: | --: | --------------------- | -------------------------- | ------------------------ |
| Tablet S           | `tablet-small`      |           1600 |       533 |   3 | 25Ã—3 = 75             | `avatar-75.avif`           | `avatar-75.webp`         |
| Tablet M           | `tablet-medium`     |           1668 |       834 |   2 | 25Ã—2 = 50             | `avatar-50.avif`           | `avatar-50.webp`         |
| Tablet L           | `tablet-large`      |           2048 |      1024 |   2 | 25Ã—2 = 50             | `avatar-50.avif`           | `avatar-50.webp`         |
| Laptop S           | `laptop-small`      |           1920 | 1280-1920 | 1.5 | 25Ã—1.5 = 37.5         | `avatar-42.avif`           | `avatar-42.webp`         |
| Laptop M           | `laptop-medium`     |           2560 | 1280-1664 |   2 | 25Ã—2 = 50             | `avatar-50.avif`           | `avatar-50.webp`         |
| Laptop L           | `laptop-large`      |           2880 | 1440-1512 |   2 | 25Ã—2 = 50             | `avatar-50.avif`           | `avatar-50.webp`         |
| Laptop XL          | `laptop-xlarge`     |           3456 |      1728 |   2 | 25Ã—2 = 50             | `avatar-50.avif`           | `avatar-50.webp`         |
| Desktop 2K         | `desktop-2k`        |           2560 |      2560 |   1 | 25Ã—1 = 25             | `avatar-30.avif`           | `avatar-30.webp`         |
| Desktop 4K         | `desktop-4k`        |           3840 |      3840 |   1 | 25Ã—1 = 25             | `avatar-30.avif`           | `avatar-30.webp`         |
| Desktop 4K @1.5x   | `desktop-4k-1.5x`   |           3840 |      2560 | 1.5 | 25Ã—1.5 = 37.5         | `avatar-42.avif`           | `avatar-42.webp`         |
| Desktop 4K @Retina | `desktop-4k-retina` |      5120â†’3840 |      2560 |   2 | 25Ã—2 = 50             | `avatar-50.avif`           | `avatar-50.webp`         |
| Desktop 6K         | `desktop-6k`        |      6016â†’3840 |      6016 |   1 | 25Ã—1 = 25             | `avatar-30.avif`           | `avatar-30.webp`         |

**è¯´æ˜**ï¼š

- ä½¿ç”¨å›ºå®šå°ºå¯¸ `sizes="25px"`ï¼Œæ‰€æœ‰è®¾å¤‡çš„ CSS æ˜¾ç¤ºå°ºå¯¸éƒ½æ˜¯ 25px
- **å“åº”å¼ä¼˜åŒ–çš„ä»·å€¼ä½“ç°**ï¼šç»„ä»¶ä¼šæ ¹æ®ä¸åŒè®¾å¤‡çš„ DPR è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜å›¾ç‰‡ï¼š
  - **DPR = 3**ï¼ˆå¦‚ Tablet Sï¼‰ï¼šéœ€è¦ 75px ç‰©ç†å®½åº¦ â†’ é€‰æ‹© `avatar-75.avif`
  - **DPR = 2**ï¼ˆå¦‚å¤šæ•°ç¬”è®°æœ¬ï¼‰ï¼šéœ€è¦ 50px ç‰©ç†å®½åº¦ â†’ é€‰æ‹© `avatar-50.avif`
  - **DPR = 1.5**ï¼ˆå¦‚éƒ¨åˆ†ç¬”è®°æœ¬ï¼‰ï¼šéœ€è¦ 37.5px ç‰©ç†å®½åº¦ â†’ é€‰æ‹© `avatar-42.avif`
  - **DPR = 1**ï¼ˆå¦‚æ¡Œé¢æ˜¾ç¤ºå™¨ï¼‰ï¼šéœ€è¦ 25px ç‰©ç†å®½åº¦ â†’ é€‰æ‹© `avatar-30.avif`
- è¿™è¯´æ˜ï¼šå³ä½¿å¼€å‘è€…åªå†™äº†ä¸€ä¸ªç®€å•çš„å›ºå®šå°ºå¯¸ï¼Œç»„ä»¶ä¹Ÿèƒ½è‡ªåŠ¨ä¸ºä¸åŒ DPR çš„è®¾å¤‡æä¾›æœ€ä¼˜çš„å›¾ç‰‡åˆ†è¾¨ç‡

---

### 5.2 Mobile ç«™ç‚¹ï¼ˆè¦†ç›– Mobileï¼‰

#### æ¼”ç¤ºåœºæ™¯ 1ï¼šè§†å£ 100% å®½ï¼ˆå¦‚ Hero Bannerï¼‰

**è®¾è®¡äº¤ä»˜**ï¼š

- **åŸå›¾å°ºå¯¸**ï¼š16:9 â†’ **1320Ã—743 JPEGï¼ˆsRGBï¼Œè´¨é‡ 90â€“95ï¼‰**
- **é 16:9**ï¼šå®½ 1320ã€é«˜æŒ‰æ¯”ä¾‹

**æ–­ç‚¹è®¡ç®—**ï¼š

```ts
const { widths } = computeMobileBreakpoints({});
// è®¡ç®—è¿‡ç¨‹ï¼š
// 1. åŸå§‹ç‰©ç†å®½åº¦: [1080, 1206, 1320]
// 2. roundStep=16 å–æ•´: [1088, 1216, 1328]
// 3. å°é¡¶åˆ° maxWidth=1320: [1088, 1216, 1320]
// widths: [1088, 1216, 1320]
```

**sizes å±æ€§è¯´æ˜**ï¼š

- å¯¹äºå…¨å®½å›¾ç‰‡ï¼Œä½¿ç”¨ `sizes="100vw"`

**Astro ç»„ä»¶ - `<Picture>`**ï¼š

```astro
---
import { Picture } from "astro:assets";
import hero from "../assets/hero-mobile.jpg";
const WIDTHS = [1088, 1216, 1320];
---

<Picture src={hero} alt="Hero banner" widths={WIDTHS} formats={["avif", "webp", "jpeg"]} sizes="100vw" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<picture>
  <source
    type="image/avif"
    srcset="/img/hero-1088.avif 1088w, /img/hero-1216.avif 1216w, /img/hero-1320.avif 1320w"
    sizes="100vw"
  />
  <source
    type="image/webp"
    srcset="/img/hero-1088.webp 1088w, /img/hero-1216.webp 1216w, /img/hero-1320.webp 1320w"
    sizes="100vw"
  />
  <img
    src="/img/hero-1216.jpeg"
    srcset="/img/hero-1088.jpeg 1088w, /img/hero-1216.jpeg 1216w, /img/hero-1320.jpeg 1320w"
    sizes="100vw"
    width="1320"
    height="743"
    alt="Hero banner"
    loading="lazy"
    decoding="async"
  />
</picture>
```

**Astro ç»„ä»¶ - `<Image>`**ï¼š

```astro
---
import { Image } from "astro:assets";
import hero from "../assets/hero-mobile.jpg";
const WIDTHS = [1088, 1216, 1320];
---

<Image src={hero} alt="Hero banner" format="webp" widths={WIDTHS} sizes="100vw" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<img
  src="/img/hero-1216.webp"
  srcset="/img/hero-1088.webp 1088w, /img/hero-1216.webp 1216w, /img/hero-1320.webp 1320w"
  sizes="100vw"
  width="1320"
  height="743"
  alt="Hero banner"
  loading="lazy"
  decoding="async"
/>
```

**è®¾å¤‡æ˜ å°„è¡¨ï¼ˆMobile ç«™ç‚¹ - 100% å®½ï¼‰**ï¼š

| è®¾å¤‡åˆ†ç±» | Device ID       | Physical Width | CSS Width | DPR | æµè§ˆå™¨é€‰æ‹©ï¼ˆPicture/AVIFï¼‰ | æµè§ˆå™¨é€‰æ‹©ï¼ˆImage/WebPï¼‰ |
| -------- | --------------- | -------------: | --------: | --: | -------------------------- | ------------------------ |
| Mobile S | `mobile-small`  |           1080 |       360 |   3 | `hero-1088.avif`           | `hero-1088.webp`         |
| Mobile M | `mobile-medium` |           1206 |       402 |   3 | `hero-1216.avif`           | `hero-1216.webp`         |
| Mobile L | `mobile-large`  |           1320 |       440 |   3 | `hero-1320.avif`           | `hero-1320.webp`         |

**æ³¨**ï¼š

- Mobile M (1206px) çš„æ–­ç‚¹åœ¨ roundStep=16 æ—¶å‘ä¸Šå–æ•´åˆ° 1216
- æµè§ˆå™¨ä¼šæ ¹æ® DPR=3 å’Œ CSS å®½åº¦è®¡ç®—éœ€è¦çš„ç‰©ç†å®½åº¦ï¼Œä» srcset ä¸­é€‰æ‹©

---

#### æ¼”ç¤ºåœºæ™¯ 2ï¼šè§†å£ 30% å®½ï¼ˆå¦‚å¡ç‰‡ç¼©ç•¥å›¾ï¼‰

**è®¾è®¡äº¤ä»˜**ï¼š

- **åŸå›¾å°ºå¯¸**ï¼š16:9 â†’ **400Ã—225 JPEGï¼ˆsRGBï¼Œè´¨é‡ 90â€“95ï¼‰**
- **é 16:9**ï¼šå®½ 400ã€é«˜æŒ‰æ¯”ä¾‹

**æ–­ç‚¹è®¡ç®—**ï¼š

```ts
const { widths } = computeMobileBreakpoints({ ratio: 0.3 });
// è®¡ç®—è¿‡ç¨‹ï¼š
// 1. åŸå§‹ç‰©ç†å®½åº¦: [1080, 1206, 1320]
// 2. æŒ‰ ratio=0.3 ç¼©æ”¾: [324, 361.8, 396]
// 3. roundStep=16 å–æ•´: [336, 368, 400]
// 4. å°é¡¶åˆ° upper=396: [336, 368, 396]
// widths: [336, 368, 396]
```

**sizes å±æ€§è¯´æ˜**ï¼š

- å¯¹äºå è§†å£ 30% å®½åº¦çš„å›¾ç‰‡ï¼Œä½¿ç”¨ `sizes="30vw"`

**Astro ç»„ä»¶ - `<Picture>`**ï¼š

```astro
---
import { Picture } from "astro:assets";
import card from "../assets/card-mobile.jpg";
const WIDTHS = [336, 368, 396];
---

<Picture src={card} alt="Card thumbnail" widths={WIDTHS} formats={["avif", "webp", "jpeg"]} sizes="30vw" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<picture>
  <source
    type="image/avif"
    srcset="/img/card-336.avif 336w, /img/card-368.avif 368w, /img/card-396.avif 396w"
    sizes="30vw"
  />
  <source
    type="image/webp"
    srcset="/img/card-336.webp 336w, /img/card-368.webp 368w, /img/card-396.webp 396w"
    sizes="30vw"
  />
  <img
    src="/img/card-368.jpeg"
    srcset="/img/card-336.jpeg 336w, /img/card-368.jpeg 368w, /img/card-396.jpeg 396w"
    sizes="30vw"
    width="396"
    height="223"
    alt="Card thumbnail"
    loading="lazy"
    decoding="async"
  />
</picture>
```

**Astro ç»„ä»¶ - `<Image>`**ï¼š

```astro
---
import { Image } from "astro:assets";
import card from "../assets/card-mobile.jpg";
const WIDTHS = [336, 368, 396];
---

<Image src={card} alt="Card thumbnail" format="webp" widths={WIDTHS} sizes="30vw" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<img
  src="/img/card-368.webp"
  srcset="/img/card-336.webp 336w, /img/card-368.webp 368w, /img/card-396.webp 396w"
  sizes="30vw"
  width="396"
  height="223"
  alt="Card thumbnail"
  loading="lazy"
  decoding="async"
/>
```

**è®¾å¤‡æ˜ å°„è¡¨ï¼ˆMobile ç«™ç‚¹ - 30% å®½ï¼‰**ï¼š

| è®¾å¤‡åˆ†ç±» | Device ID       | Physical Width | CSS Width | DPR | æµè§ˆå™¨é€‰æ‹©ï¼ˆPicture/AVIFï¼‰ | æµè§ˆå™¨é€‰æ‹©ï¼ˆImage/WebPï¼‰ |
| -------- | --------------- | -------------: | --------: | --: | -------------------------- | ------------------------ |
| Mobile S | `mobile-small`  |           1080 |       360 |   3 | `card-336.avif`            | `card-336.webp`          |
| Mobile M | `mobile-medium` |           1206 |       402 |   3 | `card-368.avif`            | `card-368.webp`          |
| Mobile L | `mobile-large`  |           1320 |       440 |   3 | `card-396.avif`            | `card-396.webp`          |

**è®¡ç®—è¯´æ˜**ï¼š

- Mobile S (CSS 360px)ï¼šæ˜¾ç¤ºå®½åº¦ = 360 Ã— 0.3 Ã— 3 (DPR) = 324px â†’ é€‰æ‹© 336.avif
- Mobile M (CSS 402px)ï¼šæ˜¾ç¤ºå®½åº¦ = 402 Ã— 0.3 Ã— 3 (DPR) â‰ˆ 362px â†’ é€‰æ‹© 368.avif
- Mobile L (CSS 440px)ï¼šæ˜¾ç¤ºå®½åº¦ = 440 Ã— 0.3 Ã— 3 (DPR) = 396px â†’ é€‰æ‹© 396.avif

---

#### æ¼”ç¤ºåœºæ™¯ 3ï¼šå›ºå®šå°ºå¯¸ 30â€“100pxï¼ˆå¦‚å¤´åƒ/å›¾æ ‡ï¼‰

**è®¾è®¡äº¤ä»˜**ï¼š

- **åŸå›¾å°ºå¯¸**ï¼š**100Ã—100 PNG**ï¼ˆæˆ–æ— æŸ WebPï¼›æ‘„å½±å¤´åƒå¯ç”¨ JPEG 90â€“95ï¼‰

**æ–­ç‚¹è®¡ç®—**ï¼š

```ts
const { widths } = computeMobileBreakpoints({
  minWidth: 30,
  maxWidth: 100,
  roundStep: 1,
});
// è®¡ç®—è¿‡ç¨‹ï¼š
// 1. åæ¨ ratio = 100 / 1320 â‰ˆ 0.076
// 2. åŸå§‹ç‰©ç†å®½åº¦: [1080, 1206, 1320]
// 3. æŒ‰ ratio=0.076 ç¼©æ”¾: [82.1, 91.7, 100.3]
// 4. roundStep=1 å–æ•´: [83, 92, 101]
// 5. å°é¡¶åˆ° maxWidth=100: [83, 92, 100]
// 6. å¼ºåˆ¶æ·»åŠ  minWidth=30: [30, 83, 92, 100]
// widths: [30, 83, 92, 100]
```

**sizes å±æ€§è¯´æ˜**ï¼š

- æœ¬åœºæ™¯ä½¿ç”¨**å›ºå®š CSS å°ºå¯¸** `28px` æ¥æ¼”ç¤ºå“åº”å¼ä¼˜åŒ–çš„æ•ˆæœ
- å³ä½¿å¼€å‘è€…åªæŒ‡å®šäº†ä¸€ä¸ªå›ºå®šçš„ CSS å°ºå¯¸ï¼Œç»„ä»¶ä¹Ÿä¼šæ ¹æ®ä¸åŒè®¾å¤‡çš„ **DPR** è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„ç‰©ç†åˆ†è¾¨ç‡å›¾ç‰‡
- ä½†éœ€æ³¨æ„ï¼šç”±äºæ‰€æœ‰ Mobile è®¾å¤‡çš„ DPR éƒ½æ˜¯ 3ï¼Œä¸åŒ Mobile è®¾å¤‡é—´çš„å·®å¼‚ä¸»è¦ä½“ç°åœ¨**åŸå§‹ç‰©ç†å®½åº¦çš„å·®å¼‚**ä¸Š

**Astro ç»„ä»¶ - `<Picture>`**ï¼š

```astro
---
import { Picture } from "astro:assets";
import avatar from "../assets/avatar.png";
const WIDTHS = [30, 83, 92, 100];
---

<Picture src={avatar} alt="User avatar" widths={WIDTHS} formats={["avif", "webp", "png"]} sizes="28px" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<picture>
  <source
    type="image/avif"
    srcset="/img/avatar-30.avif 30w, /img/avatar-83.avif 83w, /img/avatar-92.avif 92w, /img/avatar-100.avif 100w"
    sizes="28px"
  />
  <source
    type="image/webp"
    srcset="/img/avatar-30.webp 30w, /img/avatar-83.webp 83w, /img/avatar-92.webp 92w, /img/avatar-100.webp 100w"
    sizes="28px"
  />
  <img
    src="/img/avatar-83.png"
    srcset="/img/avatar-30.png 30w, /img/avatar-83.png 83w, /img/avatar-92.png 92w, /img/avatar-100.png 100w"
    sizes="28px"
    width="100"
    height="100"
    alt="User avatar"
    loading="lazy"
    decoding="async"
  />
</picture>
```

**Astro ç»„ä»¶ - `<Image>`**ï¼š

```astro
---
import { Image } from "astro:assets";
import avatar from "../assets/avatar.png";
const WIDTHS = [30, 83, 92, 100];
---

<Image src={avatar} alt="User avatar" format="webp" widths={WIDTHS} sizes="28px" />
```

**ç”Ÿæˆçš„ HTML**ï¼š

```html
<img
  src="/img/avatar-83.webp"
  srcset="/img/avatar-30.webp 30w, /img/avatar-83.webp 83w, /img/avatar-92.webp 92w, /img/avatar-100.webp 100w"
  sizes="28px"
  width="100"
  height="100"
  alt="User avatar"
  loading="lazy"
  decoding="async"
/>
```

**è®¾å¤‡æ˜ å°„è¡¨ï¼ˆMobile ç«™ç‚¹ - æ–¹å½¢ 30â€“100ï¼‰**ï¼š

| è®¾å¤‡åˆ†ç±» | Device ID       | Physical Width | CSS Width | DPR | éœ€è¦å®½åº¦ (28px Ã— DPR) | æµè§ˆå™¨é€‰æ‹©ï¼ˆPicture/AVIFï¼‰ | æµè§ˆå™¨é€‰æ‹©ï¼ˆImage/WebPï¼‰ |
| -------- | --------------- | -------------: | --------: | --: | --------------------- | -------------------------- | ------------------------ |
| Mobile S | `mobile-small`  |           1080 |       360 |   3 | 28Ã—3 = 84             | `avatar-92.avif`           | `avatar-92.webp`         |
| Mobile M | `mobile-medium` |           1206 |       402 |   3 | 28Ã—3 = 84             | `avatar-92.avif`           | `avatar-92.webp`         |
| Mobile L | `mobile-large`  |           1320 |       440 |   3 | 28Ã—3 = 84             | `avatar-92.avif`           | `avatar-92.webp`         |

**è¯´æ˜**ï¼š

- ä½¿ç”¨å›ºå®šå°ºå¯¸ `sizes="28px"`ï¼Œæ‰€æœ‰ Mobile è®¾å¤‡çš„ CSS æ˜¾ç¤ºå°ºå¯¸éƒ½æ˜¯ 28px
- æµè§ˆå™¨è®¡ç®—éœ€è¦çš„ç‰©ç†å®½åº¦ï¼š28px Ã— DPR(3) = 84px
- ä» srcset `[30, 83, 92, 100]` ä¸­é€‰æ‹©ï¼šâ‰¥84 çš„æœ€å°å€™é€‰æ˜¯ **92**
- **å…³äº Mobile å“åº”å¼çš„å±€é™æ€§**ï¼š
  - ç”±äºæ‰€æœ‰ Mobile è®¾å¤‡çš„ DPR éƒ½æ˜¯ 3ï¼Œå®ƒä»¬åœ¨å›ºå®šå°ºå¯¸åœºæ™¯ä¸‹éœ€è¦çš„ç‰©ç†å®½åº¦ç›¸åŒï¼ˆéƒ½æ˜¯ 84pxï¼‰
  - å› æ­¤å®ƒä»¬éƒ½é€‰æ‹©äº†ç›¸åŒçš„å›¾ç‰‡ï¼ˆ`avatar-92`ï¼‰ï¼Œæ— æ³•åƒ Desktop è®¾å¤‡é‚£æ ·ä½“ç°æ˜æ˜¾çš„å“åº”å¼å·®å¼‚
  - è¿™è¯´æ˜ï¼šå¯¹äº Mobile è®¾å¤‡ï¼Œå“åº”å¼å›¾ç‰‡ä¼˜åŒ–åœ¨**å…¨å®½æˆ–æ¯”ä¾‹å¸ƒå±€åœºæ™¯**ï¼ˆåœºæ™¯1å’Œåœºæ™¯2ï¼‰ä¸­æ›´æœ‰ä»·å€¼

---

## 6. éªŒè¯ä¸æ’é”™ï¼ˆHow to Verifyï¼‰

### 6.1 æµè§ˆå™¨ DevTools éªŒè¯

**Network é¢æ¿æ“ä½œæ­¥éª¤**ï¼š

1. æ‰“å¼€ DevTools â†’ Network é¢æ¿
2. ç­›é€‰å›¾ç‰‡èµ„æºï¼ˆFilter: `Img` æˆ– `image`ï¼‰
3. åˆ·æ–°é¡µé¢ï¼Œè§‚å¯ŸåŠ è½½çš„å›¾ç‰‡æ–‡ä»¶åå’Œå°ºå¯¸
4. æ£€æŸ¥ï¼š
   - å›¾ç‰‡æ–‡ä»¶åä¸­çš„å®½åº¦æ˜¯å¦ä¸é¢„æœŸçš„ `widths` æ•°ç»„åŒ¹é…
   - å›¾ç‰‡æ ¼å¼æ˜¯å¦æŒ‰ `<Picture>` ä¸­çš„ `formats` é¡ºåº fallbackï¼ˆAVIF â†’ WebP â†’ JPEG/PNGï¼‰
   - æ–‡ä»¶å¤§å°æ˜¯å¦åˆç†ï¼ˆè¿‡å¤§å¯èƒ½é€‰æ‹©äº†é”™è¯¯çš„å€™é€‰ï¼‰

**Console éªŒè¯**ï¼š

```js
// æ£€æŸ¥è§†å£å’Œ DPR ä¿¡æ¯
console.log("Viewport Width (CSS):", window.innerWidth);
console.log("DPR:", window.devicePixelRatio);
console.log("Physical Width:", window.innerWidth * window.devicePixelRatio);

// æ£€æŸ¥å›¾ç‰‡å®é™…åŠ è½½æƒ…å†µ
const img = document.querySelector('img[alt="Hero banner"]');
console.log("sizes:", img.sizes);
console.log("currentSrc:", img.currentSrc);
console.log("naturalWidth:", img.naturalWidth);
console.log("displayWidth:", img.width);
```

### 6.2 å¸¸è§é—®é¢˜æ’æŸ¥

| é—®é¢˜              | åŸå›                        | è§£å†³æ–¹æ¡ˆ                                                |
| ----------------- | -------------------------- | ------------------------------------------------------- |
| å›¾ç‰‡æ¨¡ç³Š          | é€‰æ‹©çš„å€™é€‰å®½åº¦å°äºå®é™…éœ€è¦ | æ£€æŸ¥ `sizes` æ˜¯å¦æ­£ç¡®ï¼›æ£€æŸ¥ srcset æ˜¯å¦åŒ…å«è¶³å¤Ÿå¤§çš„å€™é€‰ |
| å¸¦å®½æµªè´¹          | é€‰æ‹©çš„å€™é€‰å®½åº¦è¿‡å¤§         | æ£€æŸ¥ `sizes` æ˜¯å¦å†™å¤§äº†ï¼›æ£€æŸ¥æ˜¯å¦æœ‰è¿‡å¤šçš„å¤§å°ºå¯¸å€™é€‰     |
| æµè§ˆå™¨ä¸é€‰æ‹© AVIF | æµè§ˆå™¨ä¸æ”¯æŒ AVIF æ ¼å¼     | ä½¿ç”¨ `<Picture>` æä¾› fallback æ ¼å¼ï¼ˆWebP/JPEGï¼‰        |
| CLSï¼ˆå¸ƒå±€åç§»ï¼‰   | ç¼ºå°‘ width/height å±æ€§     | Astro ä¼šè‡ªåŠ¨å¡«å……ï¼Œæ£€æŸ¥ç”Ÿæˆçš„ HTML                       |
| `sizes` ä¸ç”Ÿæ•ˆ    | `sizes` è¯­æ³•é”™è¯¯           | æ£€æŸ¥ media query è¯­æ³•ï¼›æ£€æŸ¥æ˜¯å¦æœ‰æ‹¼å†™é”™è¯¯               |

### 6.3 è®¾å¤‡æµ‹è¯•å»ºè®®

**ä¼˜å…ˆçº§æµ‹è¯•è®¾å¤‡**ï¼š

- **Desktop**: Desktop 4K (3840 physical / 3840 CSS, DPR=1)
- **Laptop**: MacBook Pro 16â€³ (3456 physical / 1728 CSS, DPR=2)
- **Tablet**: iPad Pro 11â€³ (1668 physical / 834 CSS, DPR=2)
- **Mobile**: iPhone 17 Pro Max (1320 physical / 440 CSS, DPR=3), Galaxy S25 (1080 physical / 360 CSS, DPR=3)

**æµ‹è¯•æ­¥éª¤**ï¼š

1. åœ¨ DevTools ä¸­åˆ‡æ¢è®¾å¤‡æ¨¡æ‹Ÿå™¨
2. åˆ·æ–°é¡µé¢ï¼Œè§‚å¯Ÿ Network é¢æ¿åŠ è½½çš„å›¾ç‰‡
3. éªŒè¯ `currentSrc` æ˜¯å¦åŒ¹é…é¢„æœŸçš„å€™é€‰å®½åº¦
4. æ£€æŸ¥ `naturalWidth` æ˜¯å¦ä¸ srcset ä¸­çš„ `w` æè¿°ç¬¦ä¸€è‡´

---

## 7. Q & A

**Q1: å›¾ç‰‡å“åº”å¼ä¼˜åŒ–ä¸ CSS å“åº”å¼è®¾è®¡æœ‰ä½•åŒºåˆ«ï¼Ÿ**

A: è¿™æ˜¯ä¸¤ä¸ª**ä¸åŒé¢†åŸŸ**çš„å“åº”å¼æ¦‚å¿µï¼Œä½†ç»å¸¸è¢«æ··æ·†ï¼š

| å¯¹æ¯”é¡¹   | å›¾ç‰‡å“åº”å¼ä¼˜åŒ–ï¼ˆæœ¬æ–‡æ¡£ï¼‰         | CSS å“åº”å¼è®¾è®¡                       |
| -------- | -------------------------------- | ------------------------------------ |
| **ç›®æ ‡** | ä¼˜åŒ–å›¾ç‰‡èµ„æºï¼ŒèŠ‚çœå¸¦å®½           | è°ƒæ•´é¡µé¢å¸ƒå±€                         |
| **ä¾æ®** | **Physical Width** (ç‰©ç†åˆ†è¾¨ç‡)  | **CSS Width** (é€»è¾‘åˆ†è¾¨ç‡)           |
| **æŠ€æœ¯** | `srcset` + `sizes`               | Media Queries (`@media`)             |
| **æ–­ç‚¹** | åŸºäºç‰©ç†å®½åº¦ (1088, 1216, 1320)  | åŸºäº CSS å®½åº¦ (375px, 768px, 1024px) |
| **ç¤ºä¾‹** | MacBook Air 13â€³ åŠ è½½ 2560px å›¾ç‰‡ | MacBook Air 13â€³ ä½¿ç”¨ 1280px å¸ƒå±€     |

**å…³é”®ç†è§£**ï¼šMacBook Air 13â€³ (CSS 1280px Ã— DPR 2.0 = 2560px physical)

- **CSS å“åº”å¼**ï¼šä½¿ç”¨ `@media (min-width: 1280px)` åˆ¤æ–­å¸ƒå±€ï¼Œåº”ç”¨ Desktop æ ·å¼
- **å›¾ç‰‡å“åº”å¼**ï¼šæµè§ˆå™¨è®¡ç®—éœ€è¦ 2560px ç‰©ç†å®½åº¦ï¼Œä» `srcset` ä¸­é€‰æ‹© 2560w çš„å›¾ç‰‡

è¿™ä¸¤è€…æ˜¯**äº’è¡¥**çš„ï¼Œä¸æ˜¯æ›¿ä»£å…³ç³»ï¼š

- CSS å“åº”å¼è§£å†³"å¸ƒå±€å¦‚ä½•é€‚é…ä¸åŒå±å¹•"
- å›¾ç‰‡å“åº”å¼è§£å†³"å›¾ç‰‡å¦‚ä½•æ¸…æ™°ä¸”ä¸æµªè´¹å¸¦å®½"

**Q2: ä½•æ—¶ç”¨ `<Picture>` vs `<Image>`ï¼Ÿ**
A: å¤šæ ¼å¼ï¼ˆAVIF + WebP + JPEG â†’ `<Picture>`ï¼›å•æ ¼å¼ï¼ˆåªè¦ WebPï¼‰â†’ `<Image>`ã€‚`<Picture>` æä¾›æ›´å¥½çš„æµè§ˆå™¨å…¼å®¹æ€§ï¼Œä½†ç”Ÿæˆçš„ HTML æ›´å†—é•¿ã€‚

**Q3: ä¸ºä½•é‡‡ç”¨ç¦»æ•£æ–­ç‚¹ï¼Œè€Œä¸ä¸ºæ¯ä¸ªè®¾å¤‡ç²¾ç¡®ç”Ÿæˆå›¾ç‰‡ï¼Ÿ**
A: (1) **å®é™…å®½åº¦ä¼šæ³¢åŠ¨**ï¼šæ»šåŠ¨æ¡ã€ä¾§æ ã€çª—å£éæœ€å¤§åŒ–ç­‰å› ç´ ä¼šä½¿å®é™…æ˜¾ç¤ºå®½åº¦åç¦»è®¾å¤‡æ ‡ç§°å€¼ï¼›(2) **æµè§ˆå™¨é€‰æ‹©ç®—æ³•**ï¼šæµè§ˆå™¨ä¼šè‡ªåŠ¨é€‰æ‹©æœ€åˆé€‚çš„å€™é€‰å›¾ç‰‡ï¼ˆä¼˜å…ˆé€‰æ‹©"æœ€æ¥è¿‘ä¸”ä¸å°äºæ‰€éœ€å®½åº¦"çš„å€™é€‰ï¼Œè‹¥æ‰€æœ‰å€™é€‰éƒ½ä¸å¤Ÿå¤§åˆ™é€‰æ‹©æœ€å¤§çš„å€™é€‰ï¼‰ï¼Œè½»å¾®çš„å®½åº¦å·®å¼‚ï¼ˆå¦‚ 1668 vs 1680ï¼‰å¯¹è§†è§‰æ•ˆæœå½±å“æå°ï¼›(3) **å·¥ç¨‹æ•ˆç‡**ï¼šç¦»æ•£æ–­ç‚¹å¯å°†å€™é€‰æ•°é‡ä»æ•°åä¸ªå‡å°‘åˆ° 5-8 ä¸ªï¼Œæ˜¾è‘—é™ä½æ„å»ºæ—¶é—´å’Œå­˜å‚¨æˆæœ¬ã€‚

**Q4: Mobile ç«™ç‚¹å¦‚ä½•è¦†ç›– 1088/1216/1320ï¼Ÿ**
A: å·¥å…·æ–¹æ³• `MOBILE_PHYSICAL` å®šä¹‰ä¸ºåŸå§‹ç‰©ç†å®½åº¦ `[1080, 1206, 1320]`ï¼ŒroundStep=16 æ—¶ä¼šå‘ä¸Šå–æ•´å¾—åˆ°å·¥ç¨‹æ–­ç‚¹ `[1088, 1216, 1320]`ï¼ˆ1080 â†’ 1088, 1206 â†’ 1216, 1320 ä¿æŒä¸å˜ï¼‰ã€‚

**Q5: è®¾è®¡ç¨¿é 16:9 å¦‚ä½•å¤„ç†ï¼Ÿ**
A: äº¤ä»˜æŒ‰è®¾è®¡æ¯”ä¾‹å¯¼å‡ºï¼Œç¤ºä¾‹ä¸­çš„é«˜åº¦ï¼ˆå¦‚ 2160, 648, 743ï¼‰æ›¿æ¢ä¸ºå®é™…å€¼ã€‚Astro ä¼šè‡ªåŠ¨è¯»å–å›¾ç‰‡å®½é«˜å¹¶å¡«å……åˆ° HTMLã€‚

**Q6: è®¾å¤‡çŸ©é˜µä¸­ Laptop è®¾å¤‡çš„ CSS å®½åº¦ä¸ºä½•æ˜¯èŒƒå›´ï¼Ÿ**
A: åŒä¸€ç‰©ç†åˆ†è¾¨ç‡ï¼ˆå¦‚ 1920Ã—1080ï¼‰åœ¨ä¸åŒç¼©æ”¾æ¯”ä¾‹ï¼ˆ100%/150%ï¼‰ä¸‹ï¼ŒCSS å®½åº¦ä¸åŒã€‚æˆ‘ä»¬æŒ‰ç‰©ç†å®½åº¦åˆ†ç±»ï¼ŒCSS å®½åº¦ä»…ä¾›å‚è€ƒã€‚

**Q7: å¦‚ä½•å¤„ç† art directionï¼ˆä¸åŒè®¾å¤‡ä¸åŒè£å‰ªï¼‰ï¼Ÿ**
A: ä½¿ç”¨ `<picture>` çš„ media query åŠŸèƒ½ï¼š

```astro
<picture>
  <source media="(min-width: 1024px)" srcset="hero-desktop.jpg" />
  <source media="(min-width: 640px)" srcset="hero-tablet.jpg" />
  <img src="hero-mobile.jpg" alt="..." />
</picture>
```

ä½†æœ¬æ–¹æ¡ˆèšç„¦äºåŒä¸€å›¾ç‰‡çš„å¤šå°ºå¯¸è¾“å‡ºï¼Œä¸æ¶‰åŠä¸åŒè£å‰ªã€‚

**Q8: å¯¹äº DPR ä¸ºéæ•´æ•°ï¼ˆå¦‚ 2.625ï¼‰çš„è®¾å¤‡ï¼Œæµè§ˆå™¨å¦‚ä½•é€‰æ‹©å›¾ç‰‡ï¼Ÿ**
A: æµè§ˆå™¨ä¸å…³å¿ƒ DPR æ˜¯æ•´æ•°è¿˜æ˜¯å°æ•°ï¼Œåªå…³å¿ƒè®¡ç®—å‡ºçš„**ç‰©ç†å®½åº¦**ã€‚

**æ¡ˆä¾‹ï¼šGoogle Pixel 9**ï¼ˆDPR 2.625, CSS å®½åº¦ 412pxï¼‰

```text
éœ€è¦çš„ç‰©ç†å®½åº¦ = 412 Ã— 2.625 = 1081.5px
```

**æˆ‘ä»¬çš„ Mobile æ–­ç‚¹**: `[1088, 1216, 1320]`

æµè§ˆå™¨é€‰æ‹©è¿‡ç¨‹ï¼š

1. è®¡ç®—éœ€è¦ 1081.5px
2. ç­›é€‰ â‰¥ 1081.5px çš„å€™é€‰ï¼š`1088w`, `1216w`, `1320w`
3. é€‰æ‹©æœ€å°çš„ï¼š**`1088w`** âœ…

**å¦‚æœå€™é€‰ä¸å¤Ÿå¤§**ï¼ˆå‡è®¾åªæœ‰ `[800, 1072]`ï¼‰ï¼š

1. è®¡ç®—éœ€è¦ 1081.5px
2. ç­›é€‰ â‰¥ 1081.5px çš„å€™é€‰ï¼š**æ— **
3. é™çº§é€‰æ‹©æœ€å¤§çš„ï¼š**`1072w`** âš ï¸
4. å›¾ç‰‡ä¼šè¢«è½»å¾®æ”¾å¤§ï¼ˆ1072 â†’ 1081.5ï¼Œæ”¾å¤§çº¦ 0.89%ï¼‰ï¼Œè§†è§‰å½±å“æå°

**ä¸ºä½•æˆ‘ä»¬çš„æ–¹æ¡ˆèƒ½è¦†ç›–ä¸åŒ DPR**ï¼š

- DPR 3.0, CSS 360px â†’ 1080px â†’ é€‰ `1088w` âœ…
- DPR 2.625, CSS 412px â†’ 1081.5px â†’ é€‰ `1088w` âœ…
- DPR 3.0, CSS 402px â†’ 1206px â†’ é€‰ `1216w` âœ…

å…³é”®ï¼šæˆ‘ä»¬æŒ‰**ç‰©ç†å®½åº¦**åˆ†ç±»ï¼ˆ1088/1216/1320ï¼‰ï¼Œå¤©ç„¶é€‚é…å„ç§ DPR å€¼ã€‚

---

## 8. ç‰ˆæœ¬å†å²

### v1.0 (2025-10-16)

- ğŸ“ åˆå§‹ç‰ˆæœ¬
- âœ… åŸºäº Device Matrix v2025.1 ç¼–å†™
- âœ… å®šä¹‰è®¾å¤‡çŸ©é˜µï¼ˆMobile 3æ¡£ + Desktop 12æ¡£ï¼‰
- âœ… å®ç°åŒç«™ç‚¹åˆ†æ²»ï¼ˆDesktop ç«™ç‚¹ + Mobile ç«™ç‚¹ï¼‰
- âœ… æä¾›ä¸‰ç±»å…¸å‹åœºæ™¯ç¤ºä¾‹ï¼ˆå…¨å®½ã€30% å®½ã€å›ºå®šå°ºå¯¸ï¼‰
- âœ… æä¾›æ–­ç‚¹è®¡ç®—å·¥å…·æ–¹æ³•ï¼ˆ`computeDesktopBreakpoints` / `computeMobileBreakpoints`ï¼‰
- âœ… å®Œæ•´çš„è®¾å¤‡æ˜ å°„è¡¨å’Œæµè§ˆå™¨é€‰æ‹©éªŒè¯
- âœ… åŒ…å«éªŒè¯æ–¹æ³•å’Œ Q&A ç« èŠ‚

---

## 9. å‚è€ƒèµ„æ–™

- [Astro Assets (Images)](https://docs.astro.build/en/guides/images/)
- [MDN: Responsive images](https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images)
- [Device Matrix v2025.1](/notes/zh/device-matrix-2025/)
- [Web.dev: Serve responsive images](https://web.dev/serve-responsive-images/)

---

**æ–‡æ¡£ç»´æŠ¤**: æœ¬æ–‡æ¡£åº”éš Device Matrix æ›´æ–°è€ŒåŒæ­¥æ›´æ–°ã€‚å¦‚å‘ç°è®¾å¤‡çŸ©é˜µä¸æœ¬æ–‡æ¡£ä¸ä¸€è‡´ï¼Œè¯·ä»¥æœ€æ–°ç‰ˆ Device Matrix ä¸ºå‡†ã€‚
